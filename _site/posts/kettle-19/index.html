<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="zh-CN" >
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="stylesheet" href="/assets/css/custom.css">
  <meta name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover">

  

  

  
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件" />
<meta property="og:locale" content="zh_CN" />
<meta name="description" content="Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件" />
<meta property="og:description" content="Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件" />
<link rel="canonical" href="/posts/kettle-19/" />
<meta property="og:url" content="/posts/kettle-19/" />
<meta property="og:site_name" content="八一菜刀" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-08-15T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件" />
<meta name="twitter:site" content="@xiaoymin" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-10-14T16:49:52+08:00","datePublished":"2019-08-15T00:00:00+08:00","description":"Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件","headline":"Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/kettle-19/"},"url":"/posts/kettle-19/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件 | 八一菜刀
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="八一菜刀">
<meta name="application-name" content="八一菜刀">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
  
  <link rel="preconnect" href="https://fonts.googleapis.com" >
  <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
  
  <link rel="preconnect" href="https://fonts.googleapis.com" >
  <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
  
  <link rel="preconnect" href="https://cdn.jsdelivr.net" >
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
  

  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.2/dist/tocbot.min.css">
  

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  
  <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }
          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();
      });
    } /* constructor() */

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isSysDarkPrefer() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get isLightMode() {
      return this.mode === ModeToggle.LIGHT_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }
        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }
      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    } /* flipMode() */
  } /* ModeToggle */

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>

  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle">
      
        
        <img src="/images/common/avatar.jpeg" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      
    </a>

    <h1 class="site-title">
      <a href="/">八一菜刀</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Speak less,Do more</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>首页</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>分类</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>标签</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>归档</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>关于</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/xiaoymin"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/xiaoymin"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['xiaoymin','foxmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                首页
              </a>
            </span>

          
        
          
        
          
            
              <span>Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      文章
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="搜索..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">取消</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  <!-- CDN URL -->
  

  <!-- Add image path -->
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        发表于
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1565798400"
  data-df="YYYY/MM/DD"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  2019/08/15
</time>

      </span>

      <!-- lastmod date -->
      
      <span>
        更新于
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1697273392"
  data-df="YYYY/MM/DD"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  2023/10/14
</time>

      </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          作者

          <em>
            
            
            <a href="https://twitter.com/xiaoymin">xiaoymin</a>
            

          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2885 字"
>
  <em>16 分钟</em>阅读</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <p>我们在上面的实战系列中,多次用到了Excel作为输入或输出组件,该篇主要是针对官方英文文档做一个翻译说明,主要包括输入、输出、写入组件</p>

<h2 id="microsoft-excel-输出"><span class="me-2">Microsoft Excel 输出</span><a href="#microsoft-excel-输出" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><strong>英文地址:</strong>https://help.pentaho.com/Documentation/8.3/Products/Microsoft_Excel_Output</p>

<p>Microsoft Excel输出步骤允许您将数据写入一个或多个Excel文件。以下部分介绍了可用于配置此步骤的功能。</p>

<blockquote>
  <p><strong>说明：</strong>此步骤将数据导出到Microsoft Excel 2003电子表格文件（.xls）。如果要写入.xlsx文件（Excel 2007及更高版本），请参阅Microsoft Excel Writer步骤</p>
</blockquote>

<p>在我们的8.3版本中,Excel输出有两个组件对象,分别是<code class="language-plaintext highlighter-rouge">Excel输出</code>和<code class="language-plaintext highlighter-rouge">Microsoft Excel 输出</code>，第一个是仅支持2003版本的格式(有数量限制,且步骤设置较简单),后面<code class="language-plaintext highlighter-rouge">Microsoft Excel 输出</code>则包含了很多属性、规则设置,我们在选择Excel输出时应该选择后者,由于Spoon翻译的缘故,我们在转换核心对象树中看见的<code class="language-plaintext highlighter-rouge">Microsoft Excel 输出</code>组件实际上对应的是<code class="language-plaintext highlighter-rouge">Microsoft Excel Writer</code>组件</p>

<p><a href="/images/kettle/kettle19/kia-excel-1.png" class="popup img-link  shimmer"><img src="/images/kettle/kettle19/kia-excel-1.png" alt="" loading="lazy"></a></p>

<h3 id="文件选项"><span class="me-2">文件选项</span><a href="#文件选项" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>选项</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>步骤名称</td>
      <td>指定当前步骤的唯一步骤名称</td>
    </tr>
    <tr>
      <td>文件名</td>
      <td>输出的Excel文件名称</td>
    </tr>
    <tr>
      <td>创建父目录</td>
      <td>如果当前目录不存在则创建父目录,该选项适应于指定的文件目录不存在的情况</td>
    </tr>
    <tr>
      <td>启动时不创建文件</td>
      <td>完成此步骤后，选择以创建输出文件。当数据流中没有行时，这可以避免创建空文件</td>
    </tr>
    <tr>
      <td>扩展名</td>
      <td>固定XLS格式(因为这是2003格式的Excel)</td>
    </tr>
    <tr>
      <td>在文件中包含步骤数</td>
      <td>选择在扩展名之前的输出文件名中添加副本号。例如：nnnn_0.ext</td>
    </tr>
    <tr>
      <td>在文件名中包含日期</td>
      <td>选择在扩展名之前输出日期，例如：<code class="language-plaintext highlighter-rouge">_20190816</code></td>
    </tr>
    <tr>
      <td>在文件名中包含时间</td>
      <td>选择在扩展名之前输出时间,例如：<code class="language-plaintext highlighter-rouge">_235959</code></td>
    </tr>
    <tr>
      <td>指定时间格式</td>
      <td>选择特定的时间格式进行格式化输出以上关于时间的配置</td>
    </tr>
    <tr>
      <td>结果中添加文件名</td>
      <td>选择将文件名添加到内部文件名结果集。此内部结果集稍后可用于处理所有已创建的文件</td>
    </tr>
  </tbody>
</table></div>

<h3 id="内容选项"><span class="me-2">内容选项</span><a href="#内容选项" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="/images/kettle/kettle19/kia-excel-2.png" class="popup img-link  shimmer"><img src="/images/kettle/kettle19/kia-excel-2.png" alt="" loading="lazy"></a></p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>选项</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>追加</td>
      <td>选择将行附加到指定文件的末尾。如果该文件不存在，将创建一个新文件。</td>
    </tr>
    <tr>
      <td>头</td>
      <td>选择以显示标题（在“自定义”选项卡中定义）。标题将显示在电子表格网格数据之前。即输出表头</td>
    </tr>
    <tr>
      <td>脚</td>
      <td>选择以显示电子表格网格数据后面的页脚</td>
    </tr>
    <tr>
      <td>编码</td>
      <td>指定文件的输出编码，1、指定UTF-8或者UTF-16编码，2、空选项使用系统默认编码<br />首次使用时，PDI客户端会在系统中搜索可用的编码并相应地填充此列表。</td>
    </tr>
    <tr>
      <td>分隔每一行</td>
      <td>指定要拆分文件的行数，并启动一个新的电子表格以继续输出数据。</td>
    </tr>
    <tr>
      <td>工作表名称</td>
      <td>Excel中的Sheet名称</td>
    </tr>
    <tr>
      <td>保护工作表</td>
      <td>选择密码保护工作表。您还必须在“密码”字段中指定密码。</td>
    </tr>
    <tr>
      <td>自动调整列大小</td>
      <td>选择此选项可自动将工作表列的大小设置为最大值。</td>
    </tr>
    <tr>
      <td>保留Null值</td>
      <td>选择此选项可在输出中保留空值。 如果未选择此选项，则使用空字符串替换空值。</td>
    </tr>
    <tr>
      <td>使用临时文件</td>
      <td>指定临时文件目录</td>
    </tr>
    <tr>
      <td>使用模板</td>
      <td>选择以使用指定的Excel模板来创建输出文件。如果选择此选项，则还必须在Excel模板字段中指定模板文件名。</td>
    </tr>
    <tr>
      <td>追加Excel模板</td>
      <td>选择将输出附加到指定的Excel模板</td>
    </tr>
  </tbody>
</table></div>

<h3 id="个性化选项"><span class="me-2">个性化选项</span><a href="#个性化选项" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="/images/kettle/kettle19/kia-excel-3.png" class="popup img-link  shimmer"><img src="/images/kettle/kettle19/kia-excel-3.png" alt="" loading="lazy"></a></p>

<p>个性化选项主要包含针对输出Excel的个性配置，主要分为表头和表数据两大部分：</p>

<ul>
  <li>表头：表头字体、大小、是否加粗、斜线、斜线字体、高度、颜色等</li>
  <li>表数据：字体、大小、颜色、背景等</li>
</ul>

<h3 id="字段选项卡"><span class="me-2">字段选项卡</span><a href="#字段选项卡" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="/images/kettle/kettle19/kia-excel-4.png" class="popup img-link  shimmer"><img src="/images/kettle/kettle19/kia-excel-4.png" alt="" loading="lazy"></a></p>

<p>“字段”选项卡定义导出字段的属性。单击“获取字段”以自动从输入流中检索字段列表并填充列表。最小宽度按钮可从输出中删除任何填充。</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>选项</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>名称</td>
      <td>指定字段名称</td>
    </tr>
    <tr>
      <td>类型</td>
      <td>指定字段的数据类型(string、date或者number)</td>
    </tr>
    <tr>
      <td>格式</td>
      <td>指定字段最终输出格式</td>
    </tr>
  </tbody>
</table></div>

<p><strong>获取字段:</strong>	单击“获取字段”以从输入流中检索字段列表并填充列表。</p>

<p><strong>最小宽度:</strong>	单击“最小宽度”以从输出中删除任何多余的填充。</p>

<blockquote>
  <p><strong>说明：</strong>您可以指定Excel中可用的任何格式定义。这些格式不限于任何特定于Kettle的格式</p>
</blockquote>

<h3 id="元数据支持"><span class="me-2">元数据支持</span><a href="#元数据支持" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>此步骤的所有字段都支持元数据注入。您可以将此步骤与ETL元数据注入一起使用，以便在运行时将元数据传递给转换。</p>

<h2 id="microsoft-excel-writer"><span class="me-2">Microsoft Excel Writer</span><a href="#microsoft-excel-writer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><strong>官方文档:</strong>https://help.pentaho.com/Documentation/8.3/Products/Microsoft_Excel_Writer</p>

<p><code class="language-plaintext highlighter-rouge">Microsoft Excel Writer</code>步骤将传入的行从PDI写入MS Excel文件，并支持.xls和.xlsx文件格式。 .xls文件使用更适合简单内容的二进制格式，而.xlsx文件使用Open XML格式，该格式适用于模板，因为它可以更好地保留图表和杂项对象。</p>

<p>一般我们在做Excel导出时也是使用此组件居多.</p>

<h3 id="常规"><span class="me-2">常规</span><a href="#常规" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>指定该步骤的名称</p>

<h3 id="文件工作表-选项"><span class="me-2">文件&amp;工作表 选项</span><a href="#文件工作表-选项" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="/images/kettle/kettle19/kia-excel-5.png" class="popup img-link  shimmer"><img src="/images/kettle/kettle19/kia-excel-5.png" alt="" loading="lazy"></a></p>

<p>选项卡主要分为三个部分：文件、工作表、模板</p>

<h4 id="文件"><span class="me-2">文件</span><a href="#文件" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>此面板包括用于选择结果文件名，扩展名和时间戳信息的字段。如果数据分成多个行，则会创建多个文件。您还可以从此面板预览结果</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>字段</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>文件名称</td>
      <td>用于指定文件输出名称、存储路径</td>
    </tr>
    <tr>
      <td>扩展名</td>
      <td>选择xls或者xlsx两种格式</td>
    </tr>
    <tr>
      <td>Stream XSLX data (check box)</td>
      <td>将大型XLSX文件写入输出文件时选择此选项<br />1、如果要流式传输XLSX文件，请选择此选项。当您选中此复选框时，系统使用流API来编写大文件而没有任何内存限制（不超过MS Excel的1,048,575行和16,384列的限制）。<br />2、如果您不想流式传输XLSX文件，请清除此复选框。<br />只有选择扩展为xlsx格式时该选项才可用</td>
    </tr>
    <tr>
      <td>分隔每一行数据</td>
      <td>指定正数以在每个’n’个数据行中创建新的输出文件。例如，如果要每200个数据行拆分文件，则在此字段中输入200。文件将被编号。</td>
    </tr>
    <tr>
      <td>文件名包含步骤数目</td>
      <td>在多个副本中运行步骤时，选择此选项可在文件名（例如_0）中包含副本号，例如同时启动步骤的多个副本</td>
    </tr>
    <tr>
      <td>文件名包含日期</td>
      <td>文件名称包含日期,如：_20190916</td>
    </tr>
    <tr>
      <td>文件名包含时间</td>
      <td>文件名称包含时间，如：_235959</td>
    </tr>
    <tr>
      <td>指定日期格式</td>
      <td>指定日期的format格式</td>
    </tr>
    <tr>
      <td>如果文件已存在</td>
      <td>如果文件存在选择数据的输出方式，覆盖现有文件或者继续使用原文件输出</td>
    </tr>
    <tr>
      <td>在接收到数据钱不创建文件</td>
      <td>如果选择此选项，则该步骤仅在检测到行后才创建该文件。如果清除此选项，则始终会创建输出文件，无论行是否实际写入文件。</td>
    </tr>
    <tr>
      <td> </td>
      <td>使用此选项可将文件名添加到MS Excel输出文件中。</td>
    </tr>
  </tbody>
</table></div>

<h4 id="工作表"><span class="me-2">工作表</span><a href="#工作表" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>字段</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>工作表名</td>
      <td>输出表的sheet名称</td>
    </tr>
    <tr>
      <td>设为活动工作表</td>
      <td>如果选中，则在Excel中打开文件时，默认情况下将在上面的工作表中打开MS Excel文件</td>
    </tr>
    <tr>
      <td>如果输出文件以已经存在此工作表</td>
      <td>如果已经存在则选择输出方式，一种是覆盖、一种是继续追加输出</td>
    </tr>
    <tr>
      <td>保护工作表(仅限XLS格式)</td>
      <td>保护当前XLS格式的Excel表格,选择此项后输入保护人及密码</td>
    </tr>
  </tbody>
</table></div>

<h4 id="模板"><span class="me-2">模板</span><a href="#模板" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>When you create new files or replace existing files, you may choose to create a copy of an existing template file instead. Please make sure that the template file is of the same type as the output file: both must be either .xls or .xlsx. This panel includes fields for using template files and sheets in your Excel output file.</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Use template when creating new files (check box)</strong></td>
      <td>Select this option if you want to use a specified MS Excel template to create the output file.Select this option to specify an Excel template for use in creating the output file. If you select this option, you must also specify the template file name in the <strong>Template file</strong> field below.Clear this option if you do not want to specify a template file.</td>
    </tr>
    <tr>
      <td><strong>Template file</strong></td>
      <td>If you selected the <strong>Use template when creating new files</strong> check box above, then enter the template file name you want to use, or click the <strong>Browse</strong> button and navigate to it.</td>
    </tr>
    <tr>
      <td><strong>Use template when creating new sheets (check box)</strong></td>
      <td>Select this option if you want to use a specified template sheet to create the output sheet.Select this option to specify a template sheet for use in creating the output sheet. If you select this option, you must also specify the name of the template sheet in the <strong>Template sheet</strong> field below.Clear this option if you do not want to specify a template sheet.</td>
    </tr>
    <tr>
      <td><strong>Template sheet</strong></td>
      <td>If you selected the <strong>Use template when creating new sheets</strong> check box above, then enter the template sheet name you want to use, or click the <strong>Browse</strong> button and navigate to it.</td>
    </tr>
    <tr>
      <td><strong>Hide Template sheet (check box)</strong></td>
      <td>Decide if you want the template sheet to be visible when the MS Excel output file is opened.Select this option to hide the template sheet from users who open the output file.Clear this option to show the template sheet to users who open the output file.</td>
    </tr>
  </tbody>
</table></div>

<h3 id="内容选项-1"><span class="me-2">内容选项</span><a href="#内容选项-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>内容选项卡主要从内容和已存在的工作表相关配置</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>字段</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>开始输出自单元格</td>
      <td>默认A1,我们在分页导出数据输出到Excel时,该字段需要使用变量替代</td>
    </tr>
    <tr>
      <td>当输出记录时</td>
      <td>选择覆盖或者继续输出</td>
    </tr>
    <tr>
      <td>输出表头</td>
      <td>选择输出表头</td>
    </tr>
    <tr>
      <td>输出表尾</td>
      <td>输出表尾</td>
    </tr>
    <tr>
      <td>自动调整列大小</td>
      <td>选择此项后自动调整列大小</td>
    </tr>
    <tr>
      <td>强制公式重新计算</td>
      <td> </td>
    </tr>
    <tr>
      <td>不改变现有单元格格式</td>
      <td> </td>
    </tr>
  </tbody>
</table></div>

<h4 id="fields-panel"><span class="me-2">Fields panel</span><a href="#fields-panel" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>This panel includes <strong>Fields</strong> table for specifying the fields that are written to the Excel files. The <strong>Fields</strong> table contains the following columns:</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Column</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Name</strong></td>
      <td>The name of the field.</td>
    </tr>
    <tr>
      <td><strong>Type</strong></td>
      <td>The data type of a field: String, Date, or Number.</td>
    </tr>
    <tr>
      <td><strong>Format</strong></td>
      <td>The Excel format to use in the sheet. Please consult the Excel manual for valid formats. There are some online references as well.</td>
    </tr>
    <tr>
      <td><strong>Style from cell</strong></td>
      <td>A cell in the Excel spreadsheet (letter column, number row) such as A1, B4, etc., to copy the styling from for this column. This value is usually a pre-styled cell in a template.</td>
    </tr>
    <tr>
      <td><strong>Field title</strong></td>
      <td>If set, this is used for the Header/Footer instead of the Kettle field name.</td>
    </tr>
    <tr>
      <td><strong>Header/Footer style from cell</strong></td>
      <td>A cell to copy the styling from for the Header/Footer (usually some pre-styled cell in a template).</td>
    </tr>
    <tr>
      <td><strong>field contains formula</strong></td>
      <td>Set to Yes if the field contains an Excel formula.You do not need to include the notation = before your field value.</td>
    </tr>
    <tr>
      <td><strong>Hyperlink</strong></td>
      <td>A field that contains the target to link to. Supported targets can be links to other Excel spreadsheet cells, website URL’s, ftp’s, email addresses, or local documents.</td>
    </tr>
    <tr>
      <td><strong>Cell comment (XLSX)</strong></td>
      <td>The XLSX format allows to put comments on cells. If you would like to generate comments, you may specify fields holding the comment and author for a given column.</td>
    </tr>
    <tr>
      <td><strong>Cell comment author (XLSX)</strong></td>
      <td>The XLSX format allows to put comments on cells. If you would like to generate comments, you may specify fields holding the comment and author for a given column.</td>
    </tr>
  </tbody>
</table></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
    <div class="post-meta mb-3">
      <i class="far fa-folder-open fa-fw me-1"></i>
      
      <a href="/categories/kettle%E5%AE%9E%E6%88%98/">Kettle实战</a>
    </div>
    

    <!-- tags -->
    

    <div class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      ">
      <div class="license-wrapper">
        
        

        本文由作者按照 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         进行授权
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted me-1">分享</span>
  <span class="share-icons">
    
    
    

    
      
      <a
        href="https://twitter.com/intent/tweet?text=Kettle%E5%AE%9E%E6%88%98100%E7%AF%87%20%E7%AC%AC19%E7%AF%87%20%E8%BD%AC%E6%8D%A2%E6%A0%B8%E5%BF%83%E5%AF%B9%E8%B1%A1Microsoft%20Excel%E8%BE%93%E5%87%BA%E7%BB%84%E4%BB%B6%20-%20%E5%85%AB%E4%B8%80%E8%8F%9C%E5%88%80&url=%2Fposts%2Fkettle-19%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Twitter"
        target="_blank"
        rel="noopener"
        aria-label="Twitter"
      >
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    
      
      <a
        href="https://www.facebook.com/sharer/sharer.php?title=Kettle%E5%AE%9E%E6%88%98100%E7%AF%87%20%E7%AC%AC19%E7%AF%87%20%E8%BD%AC%E6%8D%A2%E6%A0%B8%E5%BF%83%E5%AF%B9%E8%B1%A1Microsoft%20Excel%E8%BE%93%E5%87%BA%E7%BB%84%E4%BB%B6%20-%20%E5%85%AB%E4%B8%80%E8%8F%9C%E5%88%80&u=%2Fposts%2Fkettle-19%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Facebook"
        target="_blank"
        rel="noopener"
        aria-label="Facebook"
      >
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    
      
      <a
        href="https://t.me/share/url?url=%2Fposts%2Fkettle-19%2F&text=Kettle%E5%AE%9E%E6%88%98100%E7%AF%87%20%E7%AC%AC19%E7%AF%87%20%E8%BD%AC%E6%8D%A2%E6%A0%B8%E5%BF%83%E5%AF%B9%E8%B1%A1Microsoft%20Excel%E8%BE%93%E5%87%BA%E7%BB%84%E4%BB%B6%20-%20%E5%85%AB%E4%B8%80%E8%8F%9C%E5%88%80"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Telegram"
        target="_blank"
        rel="noopener"
        aria-label="Telegram"
      >
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="分享链接"
      data-title-succeed="链接已复制！"
    >
      <i class="fa-fw fas fa-link pe-none"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>

            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get the last 5 posts from lastmod list. -->

<div class="xiaoym-qrcode">
  <div class="xiaoym-qrcode-title">
    <h2>微信公众号(八一菜刀)</h2>
  </div>
  <div style="text-align: center;"><img src="/images/website/mp/qrcode.jpg" /> </div>
</div>














<section id="access-lastmod">
  <h2 class="panel-heading">最近更新</h2>
  <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
    
    
    
    
    <li class="text-truncate lh-lg">
      <a href="/posts/llm-start/">全面进击AI大模型、RAG领域</a>
    </li>
    
    
    
    
    <li class="text-truncate lh-lg">
      <a href="/posts/rag-inaction-java/">实战0-1,Java开发者也能看懂的大模型应用RAG开发实践</a>
    </li>
    
    
    
    
    <li class="text-truncate lh-lg">
      <a href="/posts/use-prompt-framework/">用好大模型?这5种实用的Prompt框架你一定要看看!</a>
    </li>
    
    
    
    
    <li class="text-truncate lh-lg">
      <a href="/posts/knife4j-insight-mvp/">Knife4jInsight平台版-MVP版本v1.0.0发布</a>
    </li>
    
    
    
    
    <li class="text-truncate lh-lg">
      <a href="/posts/spring-boot-conditional/">Spring Boot框架中如何优雅的注入实体Bean</a>
    </li>
    
  </ul>
</section>
<!-- #access-lastmod -->

              <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">热门标签</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/llm/">LLM</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/rag/">RAG</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/rag%E5%AE%9E%E6%88%98/">RAG实战</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AE%9E%E6%88%98/">大模型实战</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">文章内容</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">相关文章</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/kettle-20/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1565798400"
  data-df="YYYY/MM/DD"
  
>
  2019/08/15
</time>

              <h4 class="pt-0 my-2">Kettle实战100篇 第20篇 MySQL数据库导出到ElasticSearch</h4>
              <div class="text-muted">
                <p>
                  





                  
  业务需求：在系统上线后,原系统的日志信息是存储到MySQL数据库中,但是随着日志数据越来越大,导致数据查询缓慢,加上日志数据并非业务系统关键数据,因此,系统考虑改版升级,使用ElasticSearch来存储日志数据,因此需要将源存在MySQL数据库上的数据迁移到ES中


简单示例

我们先来看一个简单的ES导入数据范例,建立ES的索引结构

1
PUT /scheduler_log
...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/kettle-21/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1565884800"
  data-df="YYYY/MM/DD"
  
>
  2019/08/16
</time>

              <h4 class="pt-0 my-2">Kettle实战100篇 第21篇 JavaScript内置函数说明</h4>
              <div class="text-muted">
                <p>
                  





                  我们在使用JavaScript组件的时候,在左侧核心树对象栏中可以看到Kettle为我们提供了很多简洁强大的内置函数,帮助我们在写脚本的时候对数据、参数变量等能很轻松的做处理,体验编码的感觉.本篇将详细介绍JavaScript组件中的函数功能

脚本组件包含的函数主要包括六大类,分别是：


  字符串类型的函数(String Functions)
  浮点型的函数(Numeric Func...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/kettle-22/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1565971200"
  data-df="YYYY/MM/DD"
  
>
  2019/08/17
</time>

              <h4 class="pt-0 my-2">Kettle实战100篇 第22篇 资源库的使用</h4>
              <div class="text-muted">
                <p>
                  





                  我们在前面的实战博客中,都是将我们的作业和转换文件保存在磁盘中,这在小规模的使用中是没有问题的,可是当我们的ETL工程越来越庞大时,一个团队需要更多的ETL工程师来开发ETL的过程时,单人作战就很不合适了,这就和我们开发人员写代码一样,多人协作时需要一个代码的协作平台(GIT、SVN等)来帮助我们管理代码版本，合并代码等操作

因此,当我们的ETL工程初具规模时,团队协作配合开发ETL时就需...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/kettle-18/"
      class="btn btn-outline-primary"
      aria-label="上一篇"
    >
      <p>Kettle实战100篇 第18篇 JavaScript脚本组件使用示例</p>
    </a>
  

  
    <a
      href="/posts/kettle-20/"
      class="btn btn-outline-primary"
      aria-label="下一篇"
    >
      <p>Kettle实战100篇 第20篇 MySQL数据库导出到ElasticSearch</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->

  
  <!-- https://giscus.app/ -->
<script type="text/javascript">
  (function () {
    const origin = 'https://giscus.app';
    const iframe = 'iframe.giscus-frame';
    const lightTheme = 'light';
    const darkTheme = 'dark_dimmed';

    let initTheme = lightTheme;
    const html = document.documentElement;

    if (
      (html.hasAttribute('data-mode') &&
        html.getAttribute('data-mode') === 'dark') ||
      (!html.hasAttribute('data-mode') &&
        window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      initTheme = darkTheme;
    }

    let giscusAttributes = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'xiaoymin/xiaoymin.github.io',
      'data-repo-id': 'MDEwOlJlcG9zaXRvcnk3OTUzMjIxNw==',
      'data-category': 'Comments',
      'data-category-id': 'DIC_kwDOBL2Quc4CaKF6',
      'data-mapping': 'pathname',
      'data-reactions-enabled': '1',
      'data-emit-metadata': '0',
      'data-theme': initTheme,
      'data-input-position': 'bottom',
      'data-lang': 'zh-CN',
      'data-loading': 'lazy',
      crossorigin: 'anonymous',
      async: ''
    };

    let giscusScript = document.createElement('script');
    Object.entries(giscusAttributes).forEach(([key, value]) =>
      giscusScript.setAttribute(key, value)
    );
    document.getElementById('tail-wrapper').appendChild(giscusScript);

    addEventListener('message', (event) => {
      if (
        event.source === window &&
        event.data &&
        event.data.direction === ModeToggle.ID
      ) {
        /* global theme mode changed */
        const mode = event.data.message;
        const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme;

        const message = {
          setConfig: {
            theme: theme
          }
        };

        const giscus = document.querySelector(iframe).contentWindow;
        giscus.postMessage({ giscus: message }, origin);
      }
    });
  })();
</script>



            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    ©
    <time>2023</time>
    <a href="https://twitter.com/xiaoymin">xiaoymin</a>.
    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。"
      >保留部分权利。</span>
    
  </p>

  <p>本站采用 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 主题 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">热门标签</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/llm/">LLM</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/rag/">RAG</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/rag%E5%AE%9E%E6%88%98/">RAG实战</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AE%9E%E6%88%98/">大模型实战</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">发现新版本的内容。</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      更新
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/zh.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.21.2/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

