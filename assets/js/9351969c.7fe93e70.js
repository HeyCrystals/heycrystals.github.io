"use strict";(self.webpackChunkwiki=self.webpackChunkwiki||[]).push([[1714],{3905:(e,a,n)=>{n.d(a,{Zo:()=>m,kt:()=>p});var t=n(67294);function r(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function o(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function i(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?o(Object(n),!0).forEach((function(a){r(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function l(e,a){if(null==e)return{};var n,t,r=function(e,a){if(null==e)return{};var n,t,r={},o=Object.keys(e);for(t=0;t<o.length;t++)n=o[t],a.indexOf(n)>=0||(r[n]=e[n]);return r}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)n=o[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=t.createContext({}),s=function(e){var a=t.useContext(d),n=a;return e&&(n="function"==typeof e?e(a):i(i({},a),e)),n},m=function(e){var a=s(e.components);return t.createElement(d.Provider,{value:a},e.children)},c={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},v=t.forwardRef((function(e,a){var n=e.components,r=e.mdxType,o=e.originalType,d=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),v=s(n),p=r,u=v["".concat(d,".").concat(p)]||v[p]||c[p]||o;return n?t.createElement(u,i(i({ref:a},m),{},{components:n})):t.createElement(u,i({ref:a},m))}));function p(e,a){var n=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=v;var l={};for(var d in a)hasOwnProperty.call(a,d)&&(l[d]=a[d]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return t.createElement.apply(null,i)}return t.createElement.apply(null,n)}v.displayName="MDXCreateElement"},78322:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>d,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var t=n(87462),r=(n(67294),n(3905));const o={layout:"post",title:"\u6709\u610f\u601d\u7684\u4e24\u6bb5java\u4ee3\u7801",categories:"Java",description:"\u6709\u610f\u601d\u7684\u4e24\u6bb5java\u4ee3\u7801",keywords:["java8","gc"]},i=void 0,l={unversionedId:"operate/2020-12-06-funin-java8",id:"operate/2020-12-06-funin-java8",title:"\u6709\u610f\u601d\u7684\u4e24\u6bb5java\u4ee3\u7801",description:"\u6709\u610f\u601d\u7684\u4e24\u6bb5java\u4ee3\u7801",source:"@site/programmer/blog/operate/2020-12-06-funin-java8.md",sourceDirName:"operate",slug:"/operate/2020-12-06-funin-java8",permalink:"/blog/operate/2020-12-06-funin-java8",draft:!1,editUrl:"https://github.com/xiaoymin/blog-ai/blob/master/programmer/blog/operate/2020-12-06-funin-java8.md",tags:[],version:"current",lastUpdatedBy:"xiaoyumin",lastUpdatedAt:1686478303,formattedLastUpdatedAt:"2023\u5e746\u670811\u65e5",frontMatter:{layout:"post",title:"\u6709\u610f\u601d\u7684\u4e24\u6bb5java\u4ee3\u7801",categories:"Java",description:"\u6709\u610f\u601d\u7684\u4e24\u6bb5java\u4ee3\u7801",keywords:["java8","gc"]},sidebar:"tutorialSidebar",previous:{title:"\u514d\u8d39\u7ed9\u7f51\u7ad9\u914d\u7f6eSSL\u8bc1\u4e66(https)",permalink:"/blog/operate/2019-05-07-website-ssl"},next:{title:"\u7b2c\u4e00\u7bc7 Redis\u5e38\u7528\u6570\u636e\u7ed3\u6784\u4ecb\u7ecd\u53ca\u57fa\u672c\u64cd\u4f5c",permalink:"/blog/redis/2020-11-29-redis-1"}},d={},s=[],m={toc:s};function c(e){let{components:a,...n}=e;return(0,r.kt)("wrapper",(0,t.Z)({},m,n,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"\u9996\u5148\uff0c\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f53\u7c7bOrder\u5bf9\u8c61\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'\npublic class Order{\n        private String orderNo;\n        private String name;\n\n        public Order(){\n            setOrderNo("order:"+ UUID.randomUUID().toString());\n            setName("name:"+UUID.randomUUID().toString());\n        }\n\n        public String getOrderNo() {\n            return orderNo;\n        }\n\n        public void setOrderNo(String orderNo) {\n            this.orderNo = orderNo;\n        }\n\n        public String getName() {\n            return name;\n        }\n\n        public void setName(String name) {\n            this.name = name;\n        }\n}\n\n')),(0,r.kt)("p",null,"\u7b2c\u4e00\u4e2a\xa0\u65b9\u6cd5\uff0c\u4f7f\u7528for\u5faa\u73af\u904d\u5386\u67e5\u627e\uff0c\u5373\u4f7f\u627e\u5230\u4e5f\u4e0d\u505a\u4efb\u4f55\u4e8b\uff0c\u4ee3\u7801\u7247\u6bb5\u5982\u4e0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'\nprivate static void test2(){\n        List<Order> orderList=new ArrayList<>();\n        for (int i=0;i<1000;i++){\n            orderList.add(new Order());\n        }\n        System.out.println("aaaaa");\n        boolean flag=true;\n        AtomicLong atomicLong=new AtomicLong(0);\n        do {\n            //\u904d\u5386\n            for (Order order:orderList){\n                if (order.getName().equals("abc")){\n                    //find but do nothing\n                    Optional.of(order);\n                }\n            }\n            //orderList.stream().filter(order -> order.getName().equals("abc")).findFirst();\n            long value=atomicLong.incrementAndGet();\n            if (value>10000L){\n                System.out.println("\u63a8\u51fa");\n                flag=false;\n            }\n        }while (flag);\n}\n')),(0,r.kt)("p",null,"\u7b2c\u4e8c\u4e2a\u65b9\u6cd5\uff0c\u4f7f\u7528java8\u4e2d\u7684lambda\u8868\u8fbe\u5f0fstream\u4e2d\u7684filter\u8fdb\u884c\u67e5\u627e,\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'private static void test1(){\n        List<Order> orderList=new ArrayList<>();\n        for (int i=0;i<1000;i++){\n            orderList.add(new Order());\n        }\n        System.out.println("aaaaa");\n        boolean flag=true;\n        AtomicLong atomicLong=new AtomicLong(0);\n        do {\n            //\u904d\u5386\n            orderList.stream().filter(order -> order.getName().equals("abc")).findFirst();\n            long value=atomicLong.incrementAndGet();\n            if (value>10000L){\n                System.out.println("\u63a8\u51fa");\n                flag=false;\n            }\n        }while (flag);\n}\n')),(0,r.kt)("p",null,"\u4e24\u6bb5\u4ee3\u7801\u5982\u679c\u4e0d\u8bbe\u7f6ejava\u7684Xmx\u53c2\u6570\uff0c\u90fd\u80fd\u6b63\u5e38\u8fd0\u884c\uff0c\u5047\u8bbe\u8bbe\u7f6e\u53c2\u6570"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"java -Xmx2m\n")),(0,r.kt)("p",null,"\u90a3\u4e48\u7b2c\u4e8c\u6bb5\u4f7f\u7528java8\u7684lambda\u8868\u8fbe\u5f0f\u7684\u7a0b\u5e8f\u5c06\u4f1a\u62a5\u9519\uff0c\u629b\u51fa\u5f02\u5e38"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'\nException in thread "main" java.lang.InternalError: zero_L=Lambda(a0:L)=>{\n    t1:L=LambdaForm.identity_L((null));t1:L}\n    at java.lang.invoke.MethodHandleStatics.newInternalError(MethodHandleStatics.java:127)\n    at java.lang.invoke.LambdaForm.compileToBytecode(LambdaForm.java:660)\n    at java.lang.invoke.LambdaForm.prepare(LambdaForm.java:635)\n    at java.lang.invoke.MethodHandle.<init>(MethodHandle.java:461)\n    at java.lang.invoke.BoundMethodHandle.<init>(BoundMethodHandle.java:58)\n    at java.lang.invoke.SimpleMethodHandle.<init>(SimpleMethodHandle.java:37)\n    at java.lang.invoke.SimpleMethodHandle.make(SimpleMethodHandle.java:41)\n    at java.lang.invoke.LambdaForm.createIdentityForms(LambdaForm.java:1783)\n    at java.lang.invoke.LambdaForm.<clinit>(LambdaForm.java:1833)\n    at java.lang.invoke.DirectMethodHandle.makePreparedLambdaForm(DirectMethodHandle.java:222)\n    at java.lang.invoke.DirectMethodHandle.preparedLambdaForm(DirectMethodHandle.java:187)\n    at java.lang.invoke.DirectMethodHandle.preparedLambdaForm(DirectMethodHandle.java:176)\n    at java.lang.invoke.DirectMethodHandle.make(DirectMethodHandle.java:83)\n    at java.lang.invoke.MethodHandles$Lookup.getDirectMethodCommon(MethodHandles.java:1655)\n    at java.lang.invoke.MethodHandles$Lookup.getDirectMethodNoSecurityManager(MethodHandles.java:1612)\n    at java.lang.invoke.MethodHandles$Lookup.getDirectMethodForConstant(MethodHandles.java:1797)\n    at java.lang.invoke.MethodHandles$Lookup.linkMethodHandleConstant(MethodHandles.java:1746)\n    at java.lang.invoke.MethodHandleNatives.linkMethodHandleConstant(MethodHandleNatives.java:477)\n    at com.github.xiaoymin.Java8Test.test1(Java8Test.java:63)\n    at com.github.xiaoymin.Java8Test.main(Java8Test.java:24)\nCaused by: java.lang.OutOfMemoryError: GC overhead limit exceeded\n    at jdk.internal.org.objectweb.asm.ByteVector.<init>(ByteVector.java:84)\n    at jdk.internal.org.objectweb.asm.MethodWriter.visitAnnotation(MethodWriter.java:555)\n    at java.lang.invoke.InvokerBytecodeGenerator.generateCustomizedCodeBytes(InvokerBytecodeGenerator.java:640)\n    at java.lang.invoke.InvokerBytecodeGenerator.generateCustomizedCode(InvokerBytecodeGenerator.java:618)\n    at java.lang.invoke.LambdaForm.compileToBytecode(LambdaForm.java:654)\n    ... 18 more\n*** java.lang.instrument ASSERTION FAILED ***: "!errorOutstanding" with message can\'t create byte arrau at JPLISAgent.c line: 813\n*** java.lang.instrument ASSERTION FAILED ***: "!errorOutstanding" with message can\'t create byte arrau at JPLISAgent.c line: 813\n*** java.lang.instrument ASSERTION FAILED ***: "!errorOutstanding" with message can\'t create byte arrau at JPLISAgent.c line: 813\n\n')),(0,r.kt)("p",null,"\u90a3\u4e48\uff0c\u662f\u5426\u53ef\u4ee5\u8ba4\u4e3a\u5728\u8d85\u8fc72\u5c42\u7684for\u5faa\u73af\u4e2d\uff0c\u5bf9\u4e8e\u96c6\u5408\u7684\u7b5b\u9009\u6216\u8005\u7b49\u5176\u4ed6\u5404\u79cd\u64cd\u4f5c\uff0c\u5e94\u8be5\u7981\u7528java8\u7684stream\u64cd\u4f5c\uff1f"),(0,r.kt)("p",null,"\u56e0\u4e3a\u4e00\u65e6\u5916\u5c42for\u5faa\u73af\u6b21\u6570\u8f83\u591a\uff0cjava8\u4e2d\u7684stream\u64cd\u4f5c\u5c06\u4f1a\u521b\u9020\u5f88\u591a\u4e34\u65f6\u5bf9\u8c61\uff0c\u5fc5\u7136\u5bfc\u81f4JVM\u9891\u7e41\u7684GC\u64cd\u4f5c\uff01\uff01"))}c.isMDXComponent=!0}}]);