<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-blog docs-doc-id-kettle/2019-08-15-kettle-20">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Kettle实战100篇 第20篇 MySQL数据库导出到ElasticSearch | 八一菜刀</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.xiaominfo.com/blog/kettle/2019-08-15-kettle-20"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-blog-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-blog-current"><meta data-rh="true" property="og:title" content="Kettle实战100篇 第20篇 MySQL数据库导出到ElasticSearch | 八一菜刀"><meta data-rh="true" name="description" content="Kettle实战100篇 第20篇 MySQL数据库导出到ElasticSearch"><meta data-rh="true" property="og:description" content="Kettle实战100篇 第20篇 MySQL数据库导出到ElasticSearch"><meta data-rh="true" name="keywords" content="Kettle实战,Kettlle实战100篇,Kettle in Action,Kettle,Kettle导出ES"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.xiaominfo.com/blog/kettle/2019-08-15-kettle-20"><link data-rh="true" rel="alternate" href="https://www.xiaominfo.com/blog/kettle/2019-08-15-kettle-20" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://www.xiaominfo.com/blog/kettle/2019-08-15-kettle-20" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://EL1II9W21O-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-MHMEL0F832","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MHMEL0F832"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-MHMEL0F832",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="八一菜刀" href="/opensearch.xml">





<script async defer="defer" data-website-id="23232" src="https://www.baidu.com"></script>
<script src="/js/baidu.js"></script>
<script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1589206801610969" async crossorigin="anonymous"></script><link rel="stylesheet" href="/assets/css/styles.31f948a3.css">
<link rel="preload" href="/assets/js/runtime~main.1ba6c6ba.js" as="script">
<link rel="preload" href="/assets/js/main.03a2ce36.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">🔪 八一菜刀</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">🎄 Blog</a><a class="navbar__item navbar__link" href="/opensource">🎄 开源</a><a class="navbar__item navbar__link" href="/chatgpt">🤖 ChatGPT</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">👨‍💻 MidJourney</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/getting-started">基础入门</a></li></ul></div><a class="navbar__item navbar__link" href="/langchain">🚴🏻‍♀️ langchain</a><a class="navbar__item navbar__link" href="/about">🚴🏻‍♀️ 关于</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><b>🔪 八一菜刀</b></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/blog/">个人博客</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/database/2016-10-12-mariadb-galera-startup">database</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/javascript/js-closure">javascript</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/blog/kettle/2019-08-08-kettle-1">kettle</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-08-kettle-1">Kettle实战100篇 第1篇 介绍与安装</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-08-kettle-2">Kettle实战100篇 第2篇 调用RESTful接口导入JSON结果入库</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-08-kettle-3">Kettle实战100篇 第3篇 转换核心对象JSON input组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-08-kettle-4">Kettle实战100篇 第4篇 转换核心对象REST client组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-08-kettle-toc">Kettle 实战100篇 目录</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-09-kettle-5">Kettle实战100篇 第5篇 转换核心对象生成记录组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-09-kettle-6">Kettle实战100篇 第6篇 转换核心对象字段选择组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-10-kettle-7">Kettle实战100篇 第7篇 转换核心对象插入更新组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-11-kettle-8">Kettle实战100篇 第8篇 Excel导入到Mysql数据库</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-12-kettle-10">Kettle实战100篇 第10篇 JavaScript脚本中日志输出</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-12-kettle-9">Kettle实战100篇 第9篇 Mysql数据库数据导出到Excel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-13-kettle-11">Kettle实战100篇 第11篇 JavaScript表达式变量说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-13-kettle-12">Kettle实战100篇 第12篇 自定义开发Java工具类并在JavaScript脚本中运用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-13-kettle-13">Kettle实战100篇 第13篇 MySQL数据导出Excel数据乱码</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-14-kettle-14">Kettle实战100篇 第14篇 参数与变量</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-14-kettle-15">Kettle实战100篇 第15篇 Mysql数据库表迁移</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-14-kettle-16">Kettle实战100篇 第16篇 JSON文件导入Mysql</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-14-kettle-17">Kettle实战100篇 第17篇 JSONPath组件介绍说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-15-kettle-18">Kettle实战100篇 第18篇 JavaScript脚本组件使用示例</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-15-kettle-19">Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/blog/kettle/2019-08-15-kettle-20">Kettle实战100篇 第20篇 MySQL数据库导出到ElasticSearch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-16-kettle-21">Kettle实战100篇 第21篇 JavaScript内置函数说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-17-kettle-22">Kettle实战100篇 第22篇 资源库的使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-18-kettle-23">Kettle实战100篇 第23篇 命令行介绍使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-19-kettle-24">Kettle实战100篇 第24篇 日志报表输出</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-20-kettle-25">Kettle实战100篇 第25篇 作业核心对象设置变量组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-21-kettle-26">Kettle实战100篇 第26篇 生产环境部署Pentaho</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-22-kettle-27">Kettle实战100篇 第27篇 系统级别任务调度调用转换&amp;作业</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-23-kettle-28">Kettle实战100篇 第28篇 Carte作业服务详解</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/linux/2016-11-08-deploy-standard-linux">linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/mybatis/2019-05-10-mybatis-toc">mybatis</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/operate/2016-11-15-nginx-front-intruduce">operate</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/redis/2020-11-29-redis-1">redis</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/springboot/2015-09-13-spring-mvc-jsonp-open">springboot</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/springfox/2019-05-20-springfox-0">springfox</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/workflow/2018-01-11-workflow-choose">workflow</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Kettle实战100篇 第20篇 MySQL数据库导出到ElasticSearch</h1></header><blockquote><p><strong>业务需求</strong>：在系统上线后,原系统的日志信息是存储到MySQL数据库中,但是随着日志数据越来越大,导致数据查询缓慢,加上日志数据并非业务系统关键数据,因此,系统考虑改版升级,使用ElasticSearch来存储日志数据,因此需要将源存在MySQL数据库上的数据迁移到ES中</p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="简单示例">简单示例<a href="#简单示例" class="hash-link" aria-label="简单示例的直接链接" title="简单示例的直接链接">​</a></h2><p>我们先来看一个简单的ES导入数据范例,建立ES的索引结构</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token constant" style="color:#36acaa">PUT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">scheduler_log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>建立字段信息</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token constant" style="color:#36acaa">PUT</span><span class="token plain"> scheduler_log</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_mapping</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">&quot;scheduler_log&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;properties&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">&quot;result&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;boolean&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;cql_collection&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;singleton&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">&quot;number&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;double&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;cql_collection&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;singleton&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;keyword&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;cql_collection&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;singleton&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;cql_partition_key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;cql_primary_key_order&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;keyword&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;cql_collection&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;singleton&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;cql_partition_key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;cql_primary_key_order&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">&quot;key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;keyword&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;cql_collection&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;singleton&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;cql_partition_key&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">&quot;cql_primary_key_order&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>主要有5个字段</p><p>此时,我们建立转换,随机生成1条记录导入ES,最终转换如下图：</p><p><img loading="lazy" src="data:image/png;base64,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CVpncdoYtOigrBiUKmNVq05NtrEtW4XTJ0rP81Pdsfa7PFUvZ9uWTblNEQBtaR98V/JvyKW82ly2zLs1bxIoYc0ae7oYAOAxWnd1KiFBgeb96nTgb3zO5sGBni4GAHiU9sGnevwiNLhDufp44SFBZvgBgM60Dz4l0L+RhDcP8unwa9ksSIK4PicAMMZnS92p4ZyP3alchXlEc0IPACwIvgrU5bxy8wvN+9Z586W9VONVjV+qMT26NwHgJoLPAXWKg7p7w7WCwprdvqiBULcbUufpBTf2J/AAwA6CDwCgFSa3AAC0QvABALRC8AEAtELwAQC0QvABALRC8AEAtELwAQC0QvABALRC8AEAtELwAQC0QvABALRC8AEAtELwAQC0QvABALRC8AEAtELwAQC0QvABALRC8AEAtELwAQC0QvABALRC8AEAtELwAQC0QvABALRC8AEAtELwAQC0QvABALRC8AEAtELwAQC0QvABALRC8AEAtELwAQC0QvABALRC8AEAtELwAQC0QvABALRC8AEAtELwAQC0QvABALRC8AEAtELwAQC0QvABALRC8AEAtELwAQC0QvABALRC8AEAtELwAQC08v+7SpS534OWUAAAAABJRU5ErkJggg==" width="446" height="174" class="img_ev3q"></p><p>生成记录组件很简单,设置ES索引中的字段即可,如下图：</p><p><img loading="lazy" src="/assets/images/kia-MTE-2-7ca9e0a10f4da0021721db7075226ec8.png" width="1196" height="583" class="img_ev3q"></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="elasticsearch-bulk-insert">Elasticsearch bulk insert<a href="#elasticsearch-bulk-insert" class="hash-link" aria-label="Elasticsearch bulk insert的直接链接" title="Elasticsearch bulk insert的直接链接">​</a></h3><p>主核心的组件是<code>Elasticsearch bulk insert</code>组件，该组件维护批量加载核心树目录下.</p><p><img loading="lazy" src="/assets/images/kia-MTE-3-2a72535fe047a7c639d01ec5195c2123.png" width="947" height="546" class="img_ev3q"></p><p>常规选项主要包含两个属性：索引和类型</p><p>另外需要指定ID Field字段,作为主键值</p><p><img loading="lazy" src="/assets/images/kia-MTE-4-6581b3cccf3d0daa6f7b6804f90fe3b7.png" width="947" height="546" class="img_ev3q"></p><p>服务端组件这里需要输入ES的服务端地址和端口,注意,Kettle导入ES组件使用的是ES的Java Api,并非是调用ES的RESTful接口,因此,此处的端口是使用的Transport端口,一般是9300</p><p><img loading="lazy" src="/assets/images/kia-MTE-5-93952f01cd35dbc6e20d191e3f347543.png" width="947" height="546" class="img_ev3q"></p><p>通过获取字段可以获取得到我们定义的字段</p><p><img loading="lazy" src="/assets/images/kia-MTE-6-1d218027fd93d8889d2abd4a840c3882.png" width="947" height="546" class="img_ev3q"></p><p>另外在Settings选项卡中需要指定ES的集群名称参数<code>cluster.name</code>的值</p><p>最后点击运行,查看我们的ES导入情况</p><p><img loading="lazy" src="/assets/images/kia-MTE-7-e0e287b7d8e41b9381ca92205de8c3b7.png" width="1017" height="536" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mysql数据库导入">MySQL数据库导入<a href="#mysql数据库导入" class="hash-link" aria-label="MySQL数据库导入的直接链接" title="MySQL数据库导入的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="简单导入">简单导入<a href="#简单导入" class="hash-link" aria-label="简单导入的直接链接" title="简单导入的直接链接">​</a></h3><p>从MySQL导入到ES也很简答,我们只需要使用表输入组件代替生成数据组件即可,在表数据组件中写上查询SQL语句,然后在ES组件设置匹配字段即可完成,转换图如下：</p><p><img loading="lazy" src="data:image/png;base64,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" width="707" height="253" class="img_ev3q"></p><p>表输入组件写上SQL查询语句</p><p><img loading="lazy" src="/assets/images/kia-MTE-9-6dc5db040783a0f9a7db442fe80a0582.png" width="659" height="735" class="img_ev3q"></p><p>然后在ES的组件中设置匹配字段</p><p><img loading="lazy" src="/assets/images/kia-MTE-10-d063b290b0b8d36bc4908caf2960776e.png" width="947" height="627" class="img_ev3q"></p><p>此时 即可很方便的导入数据到ES中</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="全量导入">全量导入<a href="#全量导入" class="hash-link" aria-label="全量导入的直接链接" title="全量导入的直接链接">​</a></h3><p>我们现在的需求是需要将原MySQL数据库中的表(ls_scheduler_log)全部迁移到ES中,原表目前记录大概在200W条</p><p>因此我们需要通过分页来实现该需求.既然需要用到分页,因此我们的limit和页码需要使用变量来替代,并且需要通过作业来完成</p><p>整体作业图如下：</p><p><img loading="lazy" src="/assets/images/kia-MTE-11-56015ce088e48ecbebff25fa5040fbf4.png" width="888" height="348" class="img_ev3q"></p><p>在作业中我们有两个转换和两个JavaScript组件</p><p>第一个转换是为了得到MySQL目标表中的总记录数,以获取得到总页数</p><p>第二个转换是分页同步MySQL中的数据到目标ES库中</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="设置变量">设置变量<a href="#设置变量" class="hash-link" aria-label="设置变量的直接链接" title="设置变量的直接链接">​</a></h4><p>在第一步,因为我们是分页查询MySQL数据库,因此需要事先把用到的参数变量在第一个中先预先定义,如下图：</p><p><img loading="lazy" src="/assets/images/kia-MTE-12-57f68576b49b89937783482e1da2f660.png" width="658" height="568" class="img_ev3q"></p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="计算单表总记录数">计算单表总记录数<a href="#计算单表总记录数" class="hash-link" aria-label="计算单表总记录数的直接链接" title="计算单表总记录数的直接链接">​</a></h4><p>第二步是得到我们MySQL记录表中的数据总量,以便用来计算总页数,为后面轮训分页导入到ES库做准备,转换如下图：</p><p><img loading="lazy" src="data:image/png;base64,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" width="402" height="150" class="img_ev3q"></p><p>表输入组件是一个很简单的count语句,如下图：</p><p><img loading="lazy" src="/assets/images/kia-MTE-14-557a5cdd5a292da6ef27427b1f2dca2e.png" width="1042" height="735" class="img_ev3q"></p><p>此时,我们将查询结果复制到结果,供父作业组件中使用</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="计算总页码">计算总页码<a href="#计算总页码" class="hash-link" aria-label="计算总页码的直接链接" title="计算总页码的直接链接">​</a></h4><p>在上一个步骤中我们查询得到了总记录数,因此需要一个脚本组件,用来计算总页数，脚本内容如下：</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> subject</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;自定义日志输出&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> logFactory </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">org</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">pentaho</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">di</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">core</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">logging</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">LogChannelFactory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> log</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> logFactory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">subject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//获取总记录行数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> preRows</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">previous_result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getRows</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">preRows </span><span class="token operator" style="color:#393A34">==</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> preRows</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">==</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> logCount</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">preRows</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getInteger</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;logCount&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">logMinimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;当前总记录数：&quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">logCount</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//获取变量,计算总页数,重新赋值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> pageSize</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">parent_job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;pageSize&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain">  cup</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">parent_job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;currentPage&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> ofs</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">parent_job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;offsetSize&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> nofs</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cup</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">*</span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ofs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">logMinimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;当前offsetSize:&#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">nofs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    parent_job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;offsetSize&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">nofs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">logMinimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;pageSize:&#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">pageSize</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> tempRecord</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">logCount</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">+</span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pageSize</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> totalPage</span><span class="token operator" style="color:#393A34">=</span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tempRecord</span><span class="token operator" style="color:#393A34">/</span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pageSize</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">logMinimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;总页码:&quot;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">totalPage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//赋值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    parent_job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;totalPage&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">totalPage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>通过<code>previous_result</code>对象获取得到上一个步骤的结果,最后计算得到总页码,调用<code>setVariable</code>方法覆盖变量的初始值</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="设置轮训条件">设置轮训条件<a href="#设置轮训条件" class="hash-link" aria-label="设置轮训条件的直接链接" title="设置轮训条件的直接链接">​</a></h4><p>既然是分页导入,因此我们需要一个轮训条件,条件规则就是当前页码小于等于总页码</p><p><img loading="lazy" src="/assets/images/kia-MTE-15-31aceda1648443114704b447f2d63a94.png" width="512" height="453" class="img_ev3q"></p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="开始同步至es数据源">开始同步至ES数据源<a href="#开始同步至es数据源" class="hash-link" aria-label="开始同步至ES数据源的直接链接" title="开始同步至ES数据源的直接链接">​</a></h4><p>同步ES数据转换如下：</p><p><img loading="lazy" src="data:image/png;base64,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" width="673" height="168" class="img_ev3q"></p><p>第一步是获取变量,我们在父作业组件中定义的分页变量数据,如下图：</p><p><img loading="lazy" src="/assets/images/kia-MTE-17-3c792692f91ac829b1becd4367c01d70.png" width="781" height="313" class="img_ev3q"></p><p>第二步则是在SQL分页查询中使用变量替代进行分页查询</p><p><img loading="lazy" src="/assets/images/kia-MTE-18-3c4cb8dbb96c626086da89c7c70af77b.png" width="1042" height="735" class="img_ev3q"></p><p>最后一步是设置ES的导入属性配置：</p><p><img loading="lazy" src="/assets/images/kia-MTE-19-1425b5167269bbd0e93901c1d7a89ecd.png" width="947" height="627" class="img_ev3q"></p><p><img loading="lazy" src="/assets/images/kia-MTE-20-950d15a86f990a0cf8492bb1e83e788b.png" width="947" height="627" class="img_ev3q"></p><p><img loading="lazy" src="/assets/images/kia-MTE-21-5db50eb674ee1df12897a47cdd373097.png" width="947" height="627" class="img_ev3q"></p><p><img loading="lazy" src="/assets/images/kia-MTE-22-7197345ba506b3890ec2414266b3f88e.png" width="947" height="627" class="img_ev3q"></p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="计算页码">计算页码<a href="#计算页码" class="hash-link" aria-label="计算页码的直接链接" title="计算页码的直接链接">​</a></h4><p>最后我们分页导出时,需要动态更改我们的当前页码,因此需要一个脚本组件来动态计算,脚本内容如下：</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> subject</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;自定义日志输出&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> logFactory </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">org</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">pentaho</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">di</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">core</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">logging</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">LogChannelFactory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> log</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> logFactory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">subject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//此脚本需要计算offsetSize的值以及currentPage页码的值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> currentPage</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">parent_job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;currentPage&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> totalPage</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">parent_job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;totalPage&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> pageSize</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">parent_job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;pageSize&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">logMinimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;当前页码1:&#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">currentPage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">logMinimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;总页码1：&#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">totalPage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//如果当前页码《总页码 则为true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//第二页的offset是currentPage*pageSize;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">currentPage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">totalPage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> noffSet</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">currentPage</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">pageSize</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    parent_job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;offsetSize&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">noffSet</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">logMinimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;当前offsetSize:&#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">noffSet</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//当前页码+1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    currentPage</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">logMinimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;当前页码:&#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">currentPage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">logMinimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;总页码：&#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">totalPage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    parent_job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;currentPage&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">currentPage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">logMinimal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;条件不满足,退出了。。。&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/xiaoymin/blog-ai/blob/master/programmer/blog/kettle/2019-08-15-kettle-20.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">最后<!-- -->由 <b>xiaoyumin</b> <!-- -->于 <b><time datetime="2023-06-11T10:11:43.000Z">2023年6月11日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/kettle/2019-08-15-kettle-19"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/kettle/2019-08-16-kettle-21"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Kettle实战100篇 第21篇 JavaScript内置函数说明</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#简单示例" class="table-of-contents__link toc-highlight">简单示例</a><ul><li><a href="#elasticsearch-bulk-insert" class="table-of-contents__link toc-highlight">Elasticsearch bulk insert</a></li></ul></li><li><a href="#mysql数据库导入" class="table-of-contents__link toc-highlight">MySQL数据库导入</a><ul><li><a href="#简单导入" class="table-of-contents__link toc-highlight">简单导入</a></li><li><a href="#全量导入" class="table-of-contents__link toc-highlight">全量导入</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 八一菜刀, Inc. Built with <a href="https://www.docusaurus.cn/" target="_blank" rel="noopener noreferrer">Docusaurus</a>.<br> 浙ICP备18027673号</div></div></div></footer></div>
<script src="/assets/js/runtime~main.1ba6c6ba.js"></script>
<script src="/assets/js/main.03a2ce36.js"></script>
</body>
</html>