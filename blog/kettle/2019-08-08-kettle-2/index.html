<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-blog docs-doc-id-kettle/2019-08-08-kettle-2">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Kettle实战100篇 第2篇 调用RESTful接口导入JSON结果入库 | 八一菜刀</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.xiaominfo.com/blog/kettle/2019-08-08-kettle-2"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-blog-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-blog-current"><meta data-rh="true" property="og:title" content="Kettle实战100篇 第2篇 调用RESTful接口导入JSON结果入库 | 八一菜刀"><meta data-rh="true" name="description" content="Kettle实战100篇 第2篇 调用RESTful接口导入JSON结果入库"><meta data-rh="true" property="og:description" content="Kettle实战100篇 第2篇 调用RESTful接口导入JSON结果入库"><meta data-rh="true" name="keywords" content="Kettle实战,Kettle in Action,Kettle,Kettle JSON使用"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.xiaominfo.com/blog/kettle/2019-08-08-kettle-2"><link data-rh="true" rel="alternate" href="https://www.xiaominfo.com/blog/kettle/2019-08-08-kettle-2" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://www.xiaominfo.com/blog/kettle/2019-08-08-kettle-2" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://EL1II9W21O-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-MHMEL0F832","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MHMEL0F832"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-MHMEL0F832",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="八一菜刀" href="/opensearch.xml">





<script async defer="defer" data-website-id="23232" src="https://www.baidu.com"></script>
<script src="/js/baidu.js"></script>
<script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1589206801610969" async crossorigin="anonymous"></script><link rel="stylesheet" href="/assets/css/styles.31f948a3.css">
<link rel="preload" href="/assets/js/runtime~main.1ba6c6ba.js" as="script">
<link rel="preload" href="/assets/js/main.03a2ce36.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">🔪 八一菜刀</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">🎄 Blog</a><a class="navbar__item navbar__link" href="/opensource">🎄 开源</a><a class="navbar__item navbar__link" href="/chatgpt">🤖 ChatGPT</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">👨‍💻 MidJourney</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/getting-started">基础入门</a></li></ul></div><a class="navbar__item navbar__link" href="/langchain">🚴🏻‍♀️ langchain</a><a class="navbar__item navbar__link" href="/about">🚴🏻‍♀️ 关于</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><b>🔪 八一菜刀</b></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/blog/">个人博客</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/database/2016-10-12-mariadb-galera-startup">database</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/javascript/js-closure">javascript</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/blog/kettle/2019-08-08-kettle-1">kettle</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-08-kettle-1">Kettle实战100篇 第1篇 介绍与安装</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/blog/kettle/2019-08-08-kettle-2">Kettle实战100篇 第2篇 调用RESTful接口导入JSON结果入库</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-08-kettle-3">Kettle实战100篇 第3篇 转换核心对象JSON input组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-08-kettle-4">Kettle实战100篇 第4篇 转换核心对象REST client组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-08-kettle-toc">Kettle 实战100篇 目录</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-09-kettle-5">Kettle实战100篇 第5篇 转换核心对象生成记录组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-09-kettle-6">Kettle实战100篇 第6篇 转换核心对象字段选择组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-10-kettle-7">Kettle实战100篇 第7篇 转换核心对象插入更新组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-11-kettle-8">Kettle实战100篇 第8篇 Excel导入到Mysql数据库</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-12-kettle-10">Kettle实战100篇 第10篇 JavaScript脚本中日志输出</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-12-kettle-9">Kettle实战100篇 第9篇 Mysql数据库数据导出到Excel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-13-kettle-11">Kettle实战100篇 第11篇 JavaScript表达式变量说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-13-kettle-12">Kettle实战100篇 第12篇 自定义开发Java工具类并在JavaScript脚本中运用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-13-kettle-13">Kettle实战100篇 第13篇 MySQL数据导出Excel数据乱码</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-14-kettle-14">Kettle实战100篇 第14篇 参数与变量</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-14-kettle-15">Kettle实战100篇 第15篇 Mysql数据库表迁移</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-14-kettle-16">Kettle实战100篇 第16篇 JSON文件导入Mysql</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-14-kettle-17">Kettle实战100篇 第17篇 JSONPath组件介绍说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-15-kettle-18">Kettle实战100篇 第18篇 JavaScript脚本组件使用示例</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-15-kettle-19">Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-15-kettle-20">Kettle实战100篇 第20篇 MySQL数据库导出到ElasticSearch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-16-kettle-21">Kettle实战100篇 第21篇 JavaScript内置函数说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-17-kettle-22">Kettle实战100篇 第22篇 资源库的使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-18-kettle-23">Kettle实战100篇 第23篇 命令行介绍使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-19-kettle-24">Kettle实战100篇 第24篇 日志报表输出</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-20-kettle-25">Kettle实战100篇 第25篇 作业核心对象设置变量组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-21-kettle-26">Kettle实战100篇 第26篇 生产环境部署Pentaho</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-22-kettle-27">Kettle实战100篇 第27篇 系统级别任务调度调用转换&amp;作业</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-23-kettle-28">Kettle实战100篇 第28篇 Carte作业服务详解</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/linux/2016-11-08-deploy-standard-linux">linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/mybatis/2019-05-10-mybatis-toc">mybatis</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/operate/2016-11-15-nginx-front-intruduce">operate</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/redis/2020-11-29-redis-1">redis</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/springboot/2015-09-13-spring-mvc-jsonp-open">springboot</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/springfox/2019-05-20-springfox-0">springfox</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/workflow/2018-01-11-workflow-choose">workflow</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Kettle实战100篇 第2篇 调用RESTful接口导入JSON结果入库</h1></header><p>不管是通过Java或者是Python编码的方式调用RESTful接口将结果入库,都是有一定复杂度的,首先你要加载第三方REST组件,然后连接数据库,写SQL语句,最后插入的目标数据库中</p><p>但我们有了Kettle这个工具之后,只需要使用她的图形化界面<code>Spoon</code>就可以很方便的完成接口调用及入库的操作</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="简单的get请求">简单的GET请求<a href="#简单的get请求" class="hash-link" aria-label="简单的GET请求的直接链接" title="简单的GET请求的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="需求">需求<a href="#需求" class="hash-link" aria-label="需求的直接链接" title="需求的直接链接">​</a></h3><p>我们拥有接口api地址：<code>http://xxx.domin.com/api</code></p><p>请求方式Get，无参数传递,响应内容如下：</p><p><img loading="lazy" src="/assets/images/kia-json-1-217c7a9ae1bd286165b3ac4a9d6b3f0c.png" width="898" height="283" class="img_ev3q"></p><p>我们需要将该JSON数据导入数据库中,如果<code>region</code>字段存在,则更新该数据</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="实战">实战<a href="#实战" class="hash-link" aria-label="实战的直接链接" title="实战的直接链接">​</a></h3><p>首先需要在Spoon中新建一个转换,菜单选项:文件 -&gt; 新建 -&gt; 转换</p><p>首先我们需要分析,我们这个转换操作需要哪些组件：</p><ul><li>需要输入请求url</li><li>发送RESTful请求</li><li>入库</li><li>JSON解析</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="定义变量">定义变量<a href="#定义变量" class="hash-link" aria-label="定义变量的直接链接" title="定义变量的直接链接">​</a></h4><p>既然我们的url是指定的,那么我们可以在输入对象树中选择一个<strong>生成记录</strong>的组件</p><p><img loading="lazy" src="/assets/images/kia-json-2-d0288ec3c91a5ceee854e43acfed9500.png" width="1185" height="577" class="img_ev3q"></p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="配置rest-client组件">配置REST client组件<a href="#配置rest-client组件" class="hash-link" aria-label="配置REST client组件的直接链接" title="配置REST client组件的直接链接">​</a></h4><p>设定好请求接口变量，接下来选择发送RESTFul的组件，因为我们是请求的接口,因此可以直接选择<strong>REST client</strong>组件</p><p><img loading="lazy" src="/assets/images/kia-json-3-3b9c7707b0f10c4680d11438566f2687.png" width="719" height="541" class="img_ev3q"></p><p>因为我们在生产记录的组件中定义了接口的地址,因此我们这里可以选择从字段中获取地址,然后在URL field name中选择我们上个步骤中定义的变量名称</p><p>然后选择请求类型GET,输入输出的结果变量名称result</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="定义json输入流">定义JSON输入流<a href="#定义json输入流" class="hash-link" aria-label="定义JSON输入流的直接链接" title="定义JSON输入流的直接链接">​</a></h4><p>接下来,通过REST组件,我们其实已经拿到的接口响应的JSON结果,此时我们需要一个JSON的输入流组件来接收,因此我们需要用到<strong>JSON input</strong>组件</p><p><strong>JSON input</strong>组件我们需要设定两个关键的值</p><ul><li>设置数据来源,因为我们是通过REST请求来获取的JSON,而并非是JSON文件,因此我们可以使用上个步骤中的输出字段result来作为我们的JSON输入源</li><li>设置输出隐射字段，我们得到了JSON的结果,通过接口的结果我们得知是一个JSON数组,因此我们需要设置字段名称,通过读取JSON的结果字段设置字段的映射</li></ul><p><img loading="lazy" src="/assets/images/kia-json-4-e2a464bfcf9636819341a9e22e3eeee4.png" width="988" height="768" class="img_ev3q"></p><p><img loading="lazy" src="/assets/images/kia-json-5-2c5a98d9ed0b367f12ab5e98ac2506f4.png" width="994" height="763" class="img_ev3q"></p><p>在<strong>JSON input</strong>组件中,字段的路径规则是通过<code>$.field</code>来设置的，但从上图我们可以看到,貌似并没有按照此种方式来设置，而是中间多了一层<code>[]</code>中括号，这是因为我们的目标源返回的JSON是集合,而非对象</p><p>返回集合的JSON实例：</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;title&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;我是标题&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果是以上这种方式,我们需要获取title的映射字段的话,那么我们在路径的表达式中应该写成<code>$.[*].title</code>的格式</p><p>那假设我们的JSON结果是以下这种方式：</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;title&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;我是标题&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>我们需要获取title字段的映射只需要写<code>$.title</code></p><p>如果是多级层次对象,则通过<code>.*</code>的通配符一直匹配下去即可.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="字段选择">字段选择<a href="#字段选择" class="hash-link" aria-label="字段选择的直接链接" title="字段选择的直接链接">​</a></h4><p>此时,我们已经得到了JSON输入流的字段映射关系,我们可以选择一个<strong>字段选择</strong>组件进行字段匹配</p><p><img loading="lazy" src="/assets/images/kia-json-6-1a8ebb508e0c38a4700ff466eb27765f.png" width="704" height="436" class="img_ev3q"></p><p>点击<strong>获取选择的字段</strong>按钮,可以迅速获取我们在<strong>JSON input</strong>组件中定义的映射字段</p><p>获取字段后,我们可以为字段更改名称、长度、精度等</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="数据入库">数据入库<a href="#数据入库" class="hash-link" aria-label="数据入库的直接链接" title="数据入库的直接链接">​</a></h4><p>通过以上步骤,我们已经选择了字段列表,此时,我们选择输出对象树中的<strong>插入/更新</strong>组件，将我们从接口中获取的JSON数据进行更新到数据库中</p><p>插入/更新我们从字面意思即可得知,如果我们的数据库中存在记录行则进行插入操作,否则通过指定的字段进行更新.</p><p><img loading="lazy" src="/assets/images/kia-json-7-e15599499435e86d050728208dd4271f.png" width="631" height="674" class="img_ev3q"></p><p>组件的选项卡意思也很清晰明了,先选择数据库表,如果我们没有建立数据库,则需要首先建立数据库连接,此处不再骜述</p><p>用来查询的关键字：此表可以设置我们的更新字段,即我们数据根据此字段来查询的字段，如果存在即更新</p><p>更新字段：点击获取和更新字段按钮,可以获取<strong>字段选择</strong>中我们设定好的字段列表，然后再进行选择</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="执行">执行<a href="#执行" class="hash-link" aria-label="执行的直接链接" title="执行的直接链接">​</a></h4><p>通过以上的步骤,我们已经完成了整个ETL过程的创建，如下图：</p><p><img loading="lazy" src="data:image/png;base64,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" width="737" height="192" class="img_ev3q"></p><p>此时,我们点击工具栏的运行按钮，运行我们的ETL转换</p><p><img loading="lazy" src="/assets/images/kia-json-9-0316a4c0923302d02252ac75b96ab44a.png" width="1913" height="656" class="img_ev3q"></p><p><img loading="lazy" src="/assets/images/kia-json-10-d8fd4ce05312a88eaa64614559ade7a8.png" width="684" height="589" class="img_ev3q"></p><p>运行，查看控制台日志输出</p><p><img loading="lazy" src="/assets/images/kia-json-11-e7aa98b1ef24c4ae19b9556f8112f34d.png" width="1094" height="822" class="img_ev3q"></p><p>我们在查看我们的数据库,是否已经插入成功</p><p><img loading="lazy" src="/assets/images/kia-json-12-356b941cfb8fe1e881ce2b8998a82881.png" width="876" height="589" class="img_ev3q"></p><p>数据库中已经存在数据,说明我们的整个过程是成功</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="post带参数请求">POST带参数请求<a href="#post带参数请求" class="hash-link" aria-label="POST带参数请求的直接链接" title="POST带参数请求的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="需求-1">需求<a href="#需求-1" class="hash-link" aria-label="需求的直接链接" title="需求的直接链接">​</a></h3><p>已知某POST接口<code>http://test.com/api?page=0&amp;size=100</code></p><p>发送JSON请求体:<code>{}</code></p><p>获取如下JSON结构：</p><p><img loading="lazy" src="/assets/images/kia-json-13-590ad9868897f59e1ca0687bb071f6a7.png" width="500" height="243" class="img_ev3q"></p><p>此时我们需要将content节点中的数据请求并入库</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="实战-1">实战<a href="#实战-1" class="hash-link" aria-label="实战的直接链接" title="实战的直接链接">​</a></h3><p>我们有了简单的GET请求的经验,因此当我们在构建POST请求的ETL过程的时候就简单了很多,首先我们分析需求,同样是接口地址，请求参数，因此我们第一步也是定义变量</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="定义变量-1">定义变量<a href="#定义变量-1" class="hash-link" aria-label="定义变量的直接链接" title="定义变量的直接链接">​</a></h4><p><img loading="lazy" src="/assets/images/kia-json-14-dead38779cfe4886de184d9c7eb56661.png" width="1196" height="583" class="img_ev3q"></p><p>同样的，限制条数为1条</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="配置rest-client组件-1">配置REST client组件<a href="#配置rest-client组件-1" class="hash-link" aria-label="配置REST client组件的直接链接" title="配置REST client组件的直接链接">​</a></h4><p>因为是POST请求，因此我们在REST client组件中会和GET有一些区别，如下图：</p><p><img loading="lazy" src="/assets/images/kia-json-15-7e7d7461f2f3a09b58da829f225ed349.png" width="730" height="545" class="img_ev3q"></p><p>首先设定请求类型为POST，同时设置Application Type为JSON类型，设置Body field字段，该字段为我们在请求时候发送给接口的BODY内容，和我们写Java程序时赋予的<code>application/json</code>内容是一致的，因为我们在生成记录中已经定义了BODY字段，因此在这里只需要设置字段的名称即可</p><p>第二步，我们在需求的时候有发现，POST请求还需要两个参数,分别是page和size字段，可以通过在REST client组件的Parameters选项卡中进行设定</p><p><img loading="lazy" src="/assets/images/kia-json-16-8a2c31349743b5df55e9159a01fb3b62.png" width="726" height="541" class="img_ev3q"></p><p>参数设置组件这里大家可能会产生疑问,为什么会有两列Parameter，应该如何设置，给大家说明一下：</p><p>第一列相当于设置的是参数的值,因为我们在定义变量中已经设置的变量,因此这里实际相当于是引用关系</p><p>第二列是参数的名称，也就是我们实际访问url的时候通过?paramName来访问的这个paramName参数名称</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="定义json输入流-1">定义JSON输入流<a href="#定义json输入流-1" class="hash-link" aria-label="定义JSON输入流的直接链接" title="定义JSON输入流的直接链接">​</a></h4><p>定义JSON输入流和我们在上面GET请求时介绍的差不多,唯一的区别在于我们需要根据REST client组件响应给我们的JSON格式来判断,给定不同的字段映射关系</p><p>因为我们需求的接口响应的JSON格式如下：</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;content&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;12112122&quot;</span><span class="token comment" style="color:#999988;font-style:italic">//....}],</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;first&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">//more</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>我们最终是要将content属性中的字段入库,加上我们的JSON是返回的是Object对象，因此我们的映射关系如下图：</p><p><img loading="lazy" src="/assets/images/kia-json-17-21f2cc16ea6bead529a4d19fb98f04a5.png" width="992" height="728" class="img_ev3q"></p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="字段选择-1">字段选择<a href="#字段选择-1" class="hash-link" aria-label="字段选择的直接链接" title="字段选择的直接链接">​</a></h4><p>字段选择的步骤和GET请求相同</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="数据入库-1">数据入库<a href="#数据入库-1" class="hash-link" aria-label="数据入库的直接链接" title="数据入库的直接链接">​</a></h4><p>数据入库同GET请求配置步骤</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="执行-1">执行<a href="#执行-1" class="hash-link" aria-label="执行的直接链接" title="执行的直接链接">​</a></h4><p>通过以上步骤,我们已经完成了整个ETL过程的创建,如下图：</p><p><img loading="lazy" src="/assets/images/kia-json-18-4e20c31361e0dd2144704d57e55d3804.png" width="742" height="144" class="img_ev3q"></p><p>此时,我们点击执行，查看我们的日志和数据库，如下图：</p><p><img loading="lazy" src="/assets/images/kia-json-19-666986503cf31477d51901d0180353db.png" width="912" height="487" class="img_ev3q"></p><p>通过控制台,我们已经看到是成功的，再看我们的数据库</p><p><img loading="lazy" src="/assets/images/kia-json-20-91d8c65df1d655e24dca0387569a1d82.png" width="872" height="485" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="分页发送post请求">分页发送POST请求<a href="#分页发送post请求" class="hash-link" aria-label="分页发送POST请求的直接链接" title="分页发送POST请求的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="需求-2">需求<a href="#需求-2" class="hash-link" aria-label="需求的直接链接" title="需求的直接链接">​</a></h3><p>我们在上面已经完成了POST请求的Kettle转换,但是我们会有疑问,因为接口是分页请求,此时如果我们想轮训页码,将接口的数据全部导入到数据库应该如何做呢？</p><p>可能某些人会说我们将页码大小参数size改大一点即可,加入我们的总记录行数是2W行，我们将size设置为2W，这样是否可行呢？</p><p>答案肯定是不行的,因为我们都知道,在通过请求获取的数据都是存在内存中的，2W行数据一次查询出来有可能导致内存溢出的异常,因此并不推荐这么做.</p><p>那么,我们应该如何处理呢?</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="实战-2">实战<a href="#实战-2" class="hash-link" aria-label="实战的直接链接" title="实战的直接链接">​</a></h3><p>我们通过PostMan等工具或者Chrome浏览器看到的接口请求,当前传递page=0时，返回的数据其实是附带了总页码条数的,那么我们只需要固定轮训小于等于总页码条数，每次传递不同的页码值给参数即可,这个在我们的Java或者Python等面向对象的语言中是非常容易实现的，那么在Kettle中我们应该如何实现？</p><p>此时我们需要使用到Kettle的作业，上面的POST请求实际上是一个Kettle转换,我们通过作业的方式,设定判断条件语句，对转换进行页码轮训，即可达到我们的目的.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="新建作业">新建作业<a href="#新建作业" class="hash-link" aria-label="新建作业的直接链接" title="新建作业的直接链接">​</a></h4><p>Kettle中的作业一般是以<strong>Start</strong>组件开始，并以<strong>成功</strong>组件结束</p><p>选择菜单：文件 -&gt; 新建 -&gt; 作业</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="设置变量">设置变量<a href="#设置变量" class="hash-link" aria-label="设置变量的直接链接" title="设置变量的直接链接">​</a></h4><p>我们既然需要轮询,因此我们需要把我们的相关参数设置在作业中,通过作业传递给子转换的方式,进行page页码轮询，因此我们需要把相关参数抽离出来：</p><ul><li>page:页码，初始值为0(这里根据实际需求来设定,我这边访问的接口初始从0开始)</li><li>size:每页显示数据大小,初始值200</li><li>totalPage:总页码数,我们通过接口查询1次，是可以获取得到总页码数据的，此处为122页</li><li>url:POST接口请求地址</li><li>query:POST请求参数体</li></ul><p>最终设定好后，如下图：</p><p><img loading="lazy" src="/assets/images/kia-json-21-96b43ede34310a8cce42e3f53586d9d2.png" width="658" height="568" class="img_ev3q"></p><p>我们需要注意的是,需要指定变量的有效范围,因为参数值需要传递的子作业中,我选择的范围是在JVM中有效,从字面也是也不难理解,就是在JVM运行的时候,该参数值始终有效,和我们的Session概念差不多.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="条件">条件<a href="#条件" class="hash-link" aria-label="条件的直接链接" title="条件的直接链接">​</a></h4><p>此时,我们设定了初始变量,我们需要设定我们的执行条件(当前页码&lt;总页码)，因此，从作业的核心对象树条件树中选择<strong>检查字段的值</strong>组件,如下图：</p><p><img loading="lazy" src="/assets/images/kia-json-22-a61aea61b83649a9ed9b5d29047ad550.png" width="512" height="453" class="img_ev3q"></p><p>获取page源值,判断成功条件，即page&lt;totalPage值,执行子转换</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="修改转换获取参数项">修改转换获取参数项<a href="#修改转换获取参数项" class="hash-link" aria-label="修改转换获取参数项的直接链接" title="修改转换获取参数项的直接链接">​</a></h4><p>我们通过条件检查的方式,设定了成功时需要执行子转换(POST带参数请求的转换)，因为我们把参数都提取在作业中定义,因此，我们的转换需要修改一下</p><p>把<strong>生成记录</strong>组件替换为转换核心对象树中的作业-&gt; 获取变量 组件，如下图：</p><p><img loading="lazy" src="/assets/images/kia-json-23-e03dbd037ca7fb3f49d23841b985353d.png" width="826" height="202" class="img_ev3q"></p><p>而我们的获取变量 组件 如下图：</p><p><img loading="lazy" src="/assets/images/kia-json-24-9dbcbeea2cca36f3f8fce93ff7a0eaa8.png" width="781" height="313" class="img_ev3q"></p><p>类似于我们在该转换中声明一些临时的变量,只不过变量是通过父作业传递过来。</p><p>在转换中我们只需要修改此参数的定义一处即可,后面的步骤无需更改.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="javascript脚本条件">JavaScript脚本条件<a href="#javascript脚本条件" class="hash-link" aria-label="JavaScript脚本条件的直接链接" title="JavaScript脚本条件的直接链接">​</a></h4><p>Kettle的作业执行已经执行成功了子转换,此时,我们需要根据page页码轮询,我们可以通过Javascript脚本来动态更改我们的page的值</p><p>代码逻辑如下：</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> page</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">parent_job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;page&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> totalPage</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">parent_job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;totalPage&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">page</span><span class="token operator" style="color:#393A34">==</span><span class="token plain">totalPage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    page</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    parent_job</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setVariable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;page&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">page</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>通过parent_job内置对象的getVariable()方法和setVariable()方法分别获取变量和重新赋值变量即可完成此操作</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="执行-2">执行<a href="#执行-2" class="hash-link" aria-label="执行的直接链接" title="执行的直接链接">​</a></h4><p>整个作业的创建就完成了,如下图：</p><p><img loading="lazy" src="/assets/images/kia-json-25-66b706307b9ce7d9a48265d73edb83a8.png" width="609" height="215" class="img_ev3q"></p><p>此时,我们执行作业，Kettle就会根据作业中的流程,将接口的全部数据导入到数据库中.整个ETL过程到此就完成了.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="附录">附录<a href="#附录" class="hash-link" aria-label="附录的直接链接" title="附录的直接链接">​</a></h2><p>我们在将RESTFul接口最终导入到数据库中的ETL过程中,我们使用了很多组件,关于各个组件的明细介绍可以参考以下链接进行查看:</p><ul><li>生成记录组件</li><li>REST client请求RESTful API组件</li><li>JSON input组件</li><li>字段选择组件</li><li>插入/更新组件</li><li>作业之设置变量组件</li><li>作业之检查字段的值组件</li><li>作业之JavaScript脚本组件</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/xiaoymin/blog-ai/blob/master/programmer/blog/kettle/2019-08-08-kettle-2.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">最后<!-- -->由 <b>xiaoyumin</b> <!-- -->于 <b><time datetime="2023-06-11T10:11:43.000Z">2023年6月11日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/kettle/2019-08-08-kettle-1"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Kettle实战100篇 第1篇 介绍与安装</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/kettle/2019-08-08-kettle-3"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Kettle实战100篇 第3篇 转换核心对象JSON input组件</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#简单的get请求" class="table-of-contents__link toc-highlight">简单的GET请求</a><ul><li><a href="#需求" class="table-of-contents__link toc-highlight">需求</a></li><li><a href="#实战" class="table-of-contents__link toc-highlight">实战</a></li></ul></li><li><a href="#post带参数请求" class="table-of-contents__link toc-highlight">POST带参数请求</a><ul><li><a href="#需求-1" class="table-of-contents__link toc-highlight">需求</a></li><li><a href="#实战-1" class="table-of-contents__link toc-highlight">实战</a></li></ul></li><li><a href="#分页发送post请求" class="table-of-contents__link toc-highlight">分页发送POST请求</a><ul><li><a href="#需求-2" class="table-of-contents__link toc-highlight">需求</a></li><li><a href="#实战-2" class="table-of-contents__link toc-highlight">实战</a></li></ul></li><li><a href="#附录" class="table-of-contents__link toc-highlight">附录</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 八一菜刀, Inc. Built with <a href="https://www.docusaurus.cn/" target="_blank" rel="noopener noreferrer">Docusaurus</a>.<br> 浙ICP备18027673号</div></div></div></footer></div>
<script src="/assets/js/runtime~main.1ba6c6ba.js"></script>
<script src="/assets/js/main.03a2ce36.js"></script>
</body>
</html>