<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-blog docs-doc-id-kettle/2019-08-15-kettle-19">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件 | 八一菜刀</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.xiaominfo.com/blog/kettle/2019-08-15-kettle-19"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-blog-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-blog-current"><meta data-rh="true" property="og:title" content="Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件 | 八一菜刀"><meta data-rh="true" name="description" content="Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件"><meta data-rh="true" property="og:description" content="Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件"><meta data-rh="true" name="keywords" content="Kettle实战,Kettlle实战100篇,Kettle in Action,Kettle,Kettle导出Excel"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.xiaominfo.com/blog/kettle/2019-08-15-kettle-19"><link data-rh="true" rel="alternate" href="https://www.xiaominfo.com/blog/kettle/2019-08-15-kettle-19" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://www.xiaominfo.com/blog/kettle/2019-08-15-kettle-19" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://EL1II9W21O-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-MHMEL0F832","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MHMEL0F832"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-MHMEL0F832",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="八一菜刀" href="/opensearch.xml">





<script async defer="defer" data-website-id="23232" src="https://www.baidu.com"></script>
<script src="/js/baidu.js"></script>
<script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1589206801610969" async crossorigin="anonymous"></script><link rel="stylesheet" href="/assets/css/styles.31f948a3.css">
<link rel="preload" href="/assets/js/runtime~main.794e3af1.js" as="script">
<link rel="preload" href="/assets/js/main.91d01d7d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">🔪 八一菜刀</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">🎄 Blog</a><a class="navbar__item navbar__link" href="/opensource">🎄 开源</a><a class="navbar__item navbar__link" href="/chatgpt">🤖 ChatGPT</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">👨‍💻 MidJourney</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/getting-started">基础入门</a></li></ul></div><a class="navbar__item navbar__link" href="/langchain">🚴🏻‍♀️ langchain</a><a class="navbar__item navbar__link" href="/about">🚴🏻‍♀️ 关于</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><b>🔪 八一菜刀</b></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/blog/">个人博客</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/database/2016-10-12-mariadb-galera-startup">database</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/javascript/js-closure">javascript</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/blog/kettle/2019-08-08-kettle-1">kettle</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-08-kettle-1">Kettle实战100篇 第1篇 介绍与安装</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-08-kettle-2">Kettle实战100篇 第2篇 调用RESTful接口导入JSON结果入库</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-08-kettle-3">Kettle实战100篇 第3篇 转换核心对象JSON input组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-08-kettle-4">Kettle实战100篇 第4篇 转换核心对象REST client组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-08-kettle-toc">Kettle 实战100篇 目录</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-09-kettle-5">Kettle实战100篇 第5篇 转换核心对象生成记录组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-09-kettle-6">Kettle实战100篇 第6篇 转换核心对象字段选择组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-10-kettle-7">Kettle实战100篇 第7篇 转换核心对象插入更新组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-11-kettle-8">Kettle实战100篇 第8篇 Excel导入到Mysql数据库</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-12-kettle-10">Kettle实战100篇 第10篇 JavaScript脚本中日志输出</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-12-kettle-9">Kettle实战100篇 第9篇 Mysql数据库数据导出到Excel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-13-kettle-11">Kettle实战100篇 第11篇 JavaScript表达式变量说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-13-kettle-12">Kettle实战100篇 第12篇 自定义开发Java工具类并在JavaScript脚本中运用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-13-kettle-13">Kettle实战100篇 第13篇 MySQL数据导出Excel数据乱码</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-14-kettle-14">Kettle实战100篇 第14篇 参数与变量</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-14-kettle-15">Kettle实战100篇 第15篇 Mysql数据库表迁移</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-14-kettle-16">Kettle实战100篇 第16篇 JSON文件导入Mysql</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-14-kettle-17">Kettle实战100篇 第17篇 JSONPath组件介绍说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-15-kettle-18">Kettle实战100篇 第18篇 JavaScript脚本组件使用示例</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/blog/kettle/2019-08-15-kettle-19">Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-15-kettle-20">Kettle实战100篇 第20篇 MySQL数据库导出到ElasticSearch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-16-kettle-21">Kettle实战100篇 第21篇 JavaScript内置函数说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-17-kettle-22">Kettle实战100篇 第22篇 资源库的使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-18-kettle-23">Kettle实战100篇 第23篇 命令行介绍使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-19-kettle-24">Kettle实战100篇 第24篇 日志报表输出</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-20-kettle-25">Kettle实战100篇 第25篇 作业核心对象设置变量组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-21-kettle-26">Kettle实战100篇 第26篇 生产环境部署Pentaho</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-22-kettle-27">Kettle实战100篇 第27篇 系统级别任务调度调用转换&amp;作业</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/blog/kettle/2019-08-23-kettle-28">Kettle实战100篇 第28篇 Carte作业服务详解</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/linux/2016-11-08-deploy-standard-linux">linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/mybatis/2019-05-10-mybatis-toc">mybatis</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/operate/2016-11-15-nginx-front-intruduce">operate</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/redis/2020-11-29-redis-1">redis</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/springboot/2015-09-13-spring-mvc-jsonp-open">springboot</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/springfox/2019-05-20-springfox-0">springfox</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/blog/workflow/2018-01-11-workflow-choose">workflow</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Kettle实战100篇 第19篇 转换核心对象Microsoft Excel输出组件</h1></header><p>我们在上面的实战系列中,多次用到了Excel作为输入或输出组件,该篇主要是针对官方英文文档做一个翻译说明,主要包括输入、输出、写入组件</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="microsoft-excel-输出">Microsoft Excel 输出<a href="#microsoft-excel-输出" class="hash-link" aria-label="Microsoft Excel 输出的直接链接" title="Microsoft Excel 输出的直接链接">​</a></h2><p><strong>英文地址:</strong><a href="https://help.pentaho.com/Documentation/8.3/Products/Microsoft_Excel_Output" target="_blank" rel="noopener noreferrer">https://help.pentaho.com/Documentation/8.3/Products/Microsoft_Excel_Output</a></p><p>Microsoft Excel输出步骤允许您将数据写入一个或多个Excel文件。以下部分介绍了可用于配置此步骤的功能。</p><blockquote><p><strong>说明：</strong>此步骤将数据导出到Microsoft Excel 2003电子表格文件（.xls）。如果要写入.xlsx文件（Excel 2007及更高版本），请参阅Microsoft Excel Writer步骤</p></blockquote><p>在我们的8.3版本中,Excel输出有两个组件对象,分别是<code>Excel输出</code>和<code>Microsoft Excel 输出</code>，第一个是仅支持2003版本的格式(有数量限制,且步骤设置较简单),后面<code>Microsoft Excel 输出</code>则包含了很多属性、规则设置,我们在选择Excel输出时应该选择后者,由于Spoon翻译的缘故,我们在转换核心对象树中看见的<code>Microsoft Excel 输出</code>组件实际上对应的是<code>Microsoft Excel Writer</code>组件</p><p><img loading="lazy" src="/assets/images/kia-excel-1-536a855ecaaf4e8069817c77b4079778.png" width="539" height="728" class="img_ev3q"></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="文件选项">文件选项<a href="#文件选项" class="hash-link" aria-label="文件选项的直接链接" title="文件选项的直接链接">​</a></h3><table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>步骤名称</td><td>指定当前步骤的唯一步骤名称</td></tr><tr><td>文件名</td><td>输出的Excel文件名称</td></tr><tr><td>创建父目录</td><td>如果当前目录不存在则创建父目录,该选项适应于指定的文件目录不存在的情况</td></tr><tr><td>启动时不创建文件</td><td>完成此步骤后，选择以创建输出文件。当数据流中没有行时，这可以避免创建空文件</td></tr><tr><td>扩展名</td><td>固定XLS格式(因为这是2003格式的Excel)</td></tr><tr><td>在文件中包含步骤数</td><td>选择在扩展名之前的输出文件名中添加副本号。例如：nnnn_0.ext</td></tr><tr><td>在文件名中包含日期</td><td>选择在扩展名之前输出日期，例如：<code>_20190816</code></td></tr><tr><td>在文件名中包含时间</td><td>选择在扩展名之前输出时间,例如：<code>_235959</code></td></tr><tr><td>指定时间格式</td><td>选择特定的时间格式进行格式化输出以上关于时间的配置</td></tr><tr><td>结果中添加文件名</td><td>选择将文件名添加到内部文件名结果集。此内部结果集稍后可用于处理所有已创建的文件</td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="内容选项">内容选项<a href="#内容选项" class="hash-link" aria-label="内容选项的直接链接" title="内容选项的直接链接">​</a></h3><p><img loading="lazy" src="/assets/images/kia-excel-2-cbcd24526b1cebb7a9833f8fdd5224cc.png" width="539" height="728" class="img_ev3q"></p><table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>追加</td><td>选择将行附加到指定文件的末尾。如果该文件不存在，将创建一个新文件。</td></tr><tr><td>头</td><td>选择以显示标题（在“自定义”选项卡中定义）。标题将显示在电子表格网格数据之前。即输出表头</td></tr><tr><td>脚</td><td>选择以显示电子表格网格数据后面的页脚</td></tr><tr><td>编码</td><td>指定文件的输出编码，1、指定UTF-8或者UTF-16编码，2、空选项使用系统默认编码<br>首次使用时，PDI客户端会在系统中搜索可用的编码并相应地填充此列表。</td></tr><tr><td>分隔每一行</td><td>指定要拆分文件的行数，并启动一个新的电子表格以继续输出数据。</td></tr><tr><td>工作表名称</td><td>Excel中的Sheet名称</td></tr><tr><td>保护工作表</td><td>选择密码保护工作表。您还必须在“密码”字段中指定密码。</td></tr><tr><td>自动调整列大小</td><td>选择此选项可自动将工作表列的大小设置为最大值。</td></tr><tr><td>保留Null值</td><td>选择此选项可在输出中保留空值。 如果未选择此选项，则使用空字符串替换空值。</td></tr><tr><td>使用临时文件</td><td>指定临时文件目录</td></tr><tr><td>使用模板</td><td>选择以使用指定的Excel模板来创建输出文件。如果选择此选项，则还必须在Excel模板字段中指定模板文件名。</td></tr><tr><td>追加Excel模板</td><td>选择将输出附加到指定的Excel模板</td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="个性化选项">个性化选项<a href="#个性化选项" class="hash-link" aria-label="个性化选项的直接链接" title="个性化选项的直接链接">​</a></h3><p><img loading="lazy" src="/assets/images/kia-excel-3-6d9400e721e80f95322cdbe6d880e3c2.png" width="539" height="728" class="img_ev3q"></p><p>个性化选项主要包含针对输出Excel的个性配置，主要分为表头和表数据两大部分：</p><ul><li>表头：表头字体、大小、是否加粗、斜线、斜线字体、高度、颜色等</li><li>表数据：字体、大小、颜色、背景等</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="字段选项卡">字段选项卡<a href="#字段选项卡" class="hash-link" aria-label="字段选项卡的直接链接" title="字段选项卡的直接链接">​</a></h3><p><img loading="lazy" src="/assets/images/kia-excel-4-e4bd1de9048c6a6a6746223b344d2e90.png" width="539" height="728" class="img_ev3q"></p><p>“字段”选项卡定义导出字段的属性。单击“获取字段”以自动从输入流中检索字段列表并填充列表。最小宽度按钮可从输出中删除任何填充。</p><table><thead><tr><th>选项</th><th>描述</th></tr></thead><tbody><tr><td>名称</td><td>指定字段名称</td></tr><tr><td>类型</td><td>指定字段的数据类型(string、date或者number)</td></tr><tr><td>格式</td><td>指定字段最终输出格式</td></tr></tbody></table><p><strong>获取字段:</strong>	单击“获取字段”以从输入流中检索字段列表并填充列表。</p><p><strong>最小宽度:</strong>	单击“最小宽度”以从输出中删除任何多余的填充。</p><blockquote><p><strong>说明：</strong>您可以指定Excel中可用的任何格式定义。这些格式不限于任何特定于Kettle的格式</p></blockquote><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="元数据支持">元数据支持<a href="#元数据支持" class="hash-link" aria-label="元数据支持的直接链接" title="元数据支持的直接链接">​</a></h3><p>此步骤的所有字段都支持元数据注入。您可以将此步骤与ETL元数据注入一起使用，以便在运行时将元数据传递给转换。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="microsoft-excel-writer">Microsoft Excel Writer<a href="#microsoft-excel-writer" class="hash-link" aria-label="Microsoft Excel Writer的直接链接" title="Microsoft Excel Writer的直接链接">​</a></h2><p><strong>官方文档:</strong><a href="https://help.pentaho.com/Documentation/8.3/Products/Microsoft_Excel_Writer" target="_blank" rel="noopener noreferrer">https://help.pentaho.com/Documentation/8.3/Products/Microsoft_Excel_Writer</a></p><p><code>Microsoft Excel Writer</code>步骤将传入的行从PDI写入MS Excel文件，并支持.xls和.xlsx文件格式。 .xls文件使用更适合简单内容的二进制格式，而.xlsx文件使用Open XML格式，该格式适用于模板，因为它可以更好地保留图表和杂项对象。</p><p>一般我们在做Excel导出时也是使用此组件居多.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="常规">常规<a href="#常规" class="hash-link" aria-label="常规的直接链接" title="常规的直接链接">​</a></h3><p>指定该步骤的名称</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="文件工作表-选项">文件&amp;工作表 选项<a href="#文件工作表-选项" class="hash-link" aria-label="文件&amp;工作表 选项的直接链接" title="文件&amp;工作表 选项的直接链接">​</a></h3><p><img loading="lazy" src="/assets/images/kia-excel-5-ebdfb59eb158300b254f112eff984508.png" width="1029" height="896" class="img_ev3q"></p><p>选项卡主要分为三个部分：文件、工作表、模板</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="文件">文件<a href="#文件" class="hash-link" aria-label="文件的直接链接" title="文件的直接链接">​</a></h4><p>此面板包括用于选择结果文件名，扩展名和时间戳信息的字段。如果数据分成多个行，则会创建多个文件。您还可以从此面板预览结果</p><table><thead><tr><th>字段</th><th>说明</th></tr></thead><tbody><tr><td>文件名称</td><td>用于指定文件输出名称、存储路径</td></tr><tr><td>扩展名</td><td>选择xls或者xlsx两种格式</td></tr><tr><td>Stream XSLX data (check box)</td><td>将大型XLSX文件写入输出文件时选择此选项<br>1、如果要流式传输XLSX文件，请选择此选项。当您选中此复选框时，系统使用流API来编写大文件而没有任何内存限制（不超过MS Excel的1,048,575行和16,384列的限制）。<br>2、如果您不想流式传输XLSX文件，请清除此复选框。<br>只有选择扩展为xlsx格式时该选项才可用</td></tr><tr><td>分隔每一行数据</td><td>指定正数以在每个&#x27;n&#x27;个数据行中创建新的输出文件。例如，如果要每200个数据行拆分文件，则在此字段中输入200。文件将被编号。</td></tr><tr><td>文件名包含步骤数目</td><td>在多个副本中运行步骤时，选择此选项可在文件名（例如_0）中包含副本号，例如同时启动步骤的多个副本</td></tr><tr><td>文件名包含日期</td><td>文件名称包含日期,如：_20190916</td></tr><tr><td>文件名包含时间</td><td>文件名称包含时间，如：_235959</td></tr><tr><td>指定日期格式</td><td>指定日期的format格式</td></tr><tr><td>如果文件已存在</td><td>如果文件存在选择数据的输出方式，覆盖现有文件或者继续使用原文件输出</td></tr><tr><td>在接收到数据钱不创建文件</td><td>如果选择此选项，则该步骤仅在检测到行后才创建该文件。如果清除此选项，则始终会创建输出文件，无论行是否实际写入文件。</td></tr><tr><td></td><td>使用此选项可将文件名添加到MS Excel输出文件中。</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="工作表">工作表<a href="#工作表" class="hash-link" aria-label="工作表的直接链接" title="工作表的直接链接">​</a></h4><table><thead><tr><th>字段</th><th>说明</th></tr></thead><tbody><tr><td>工作表名</td><td>输出表的sheet名称</td></tr><tr><td>设为活动工作表</td><td>如果选中，则在Excel中打开文件时，默认情况下将在上面的工作表中打开MS Excel文件</td></tr><tr><td>如果输出文件以已经存在此工作表</td><td>如果已经存在则选择输出方式，一种是覆盖、一种是继续追加输出</td></tr><tr><td>保护工作表(仅限XLS格式)</td><td>保护当前XLS格式的Excel表格,选择此项后输入保护人及密码</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="模板">模板<a href="#模板" class="hash-link" aria-label="模板的直接链接" title="模板的直接链接">​</a></h4><p>When you create new files or replace existing files, you may choose to create a copy of an existing template file instead. Please make sure that the template file is of the same type as the output file: both must be either .xls or .xlsx. This panel includes fields for using template files and sheets in your Excel output file.</p><table><thead><tr><th>Field</th><th>Description</th></tr></thead><tbody><tr><td><strong>Use template when creating new files (check box)</strong></td><td>Select this option if you want to use a specified MS Excel template to create the output file.Select this option to specify an Excel template for use in creating the output file. If you select this option, you must also specify the template file name in the <strong>Template file</strong> field below.Clear this option if you do not want to specify a template file.</td></tr><tr><td><strong>Template file</strong></td><td>If you selected the <strong>Use template when creating new files</strong> check box above, then enter the template file name you want to use, or click the <strong>Browse</strong> button and navigate to it.</td></tr><tr><td><strong>Use template when creating new sheets (check box)</strong></td><td>Select this option if you want to use a specified template sheet to create the output sheet.Select this option to specify a template sheet for use in creating the output sheet. If you select this option, you must also specify the name of the template sheet in the <strong>Template sheet</strong> field below.Clear this option if you do not want to specify a template sheet.</td></tr><tr><td><strong>Template sheet</strong></td><td>If you selected the <strong>Use template when creating new sheets</strong> check box above, then enter the template sheet name you want to use, or click the <strong>Browse</strong> button and navigate to it.</td></tr><tr><td><strong>Hide Template sheet (check box)</strong></td><td>Decide if you want the template sheet to be visible when the MS Excel output file is opened.Select this option to hide the template sheet from users who open the output file.Clear this option to show the template sheet to users who open the output file.</td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="内容选项-1">内容选项<a href="#内容选项-1" class="hash-link" aria-label="内容选项的直接链接" title="内容选项的直接链接">​</a></h3><p>内容选项卡主要从内容和已存在的工作表相关配置</p><table><thead><tr><th>字段</th><th>说明</th></tr></thead><tbody><tr><td>开始输出自单元格</td><td>默认A1,我们在分页导出数据输出到Excel时,该字段需要使用变量替代</td></tr><tr><td>当输出记录时</td><td>选择覆盖或者继续输出</td></tr><tr><td>输出表头</td><td>选择输出表头</td></tr><tr><td>输出表尾</td><td>输出表尾</td></tr><tr><td>自动调整列大小</td><td>选择此项后自动调整列大小</td></tr><tr><td>强制公式重新计算</td><td></td></tr><tr><td>不改变现有单元格格式</td><td></td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="fields-panel">Fields panel<a href="#fields-panel" class="hash-link" aria-label="Fields panel的直接链接" title="Fields panel的直接链接">​</a></h4><p>This panel includes <strong>Fields</strong> table for specifying the fields that are written to the Excel files. The <strong>Fields</strong> table contains the following columns:</p><table><thead><tr><th>Column</th><th>Description</th></tr></thead><tbody><tr><td><strong>Name</strong></td><td>The name of the field.</td></tr><tr><td><strong>Type</strong></td><td>The data type of a field: String, Date, or Number.</td></tr><tr><td><strong>Format</strong></td><td>The Excel format to use in the sheet. Please consult the Excel manual for valid formats. There are some online references as well.</td></tr><tr><td><strong>Style from cell</strong></td><td>A cell in the Excel spreadsheet (letter column, number row) such as A1, B4, etc., to copy the styling from for this column. This value is usually a pre-styled cell in a template.</td></tr><tr><td><strong>Field title</strong></td><td>If set, this is used for the Header/Footer instead of the Kettle field name.</td></tr><tr><td><strong>Header/Footer style from cell</strong></td><td>A cell to copy the styling from for the Header/Footer (usually some pre-styled cell in a template).</td></tr><tr><td><strong>field contains formula</strong></td><td>Set to Yes if the field contains an Excel formula.You do not need to include the notation = before your field value.</td></tr><tr><td><strong>Hyperlink</strong></td><td>A field that contains the target to link to. Supported targets can be links to other Excel spreadsheet cells, website URL&#x27;s, ftp&#x27;s, email addresses, or local documents.</td></tr><tr><td><strong>Cell comment (XLSX)</strong></td><td>The XLSX format allows to put comments on cells. If you would like to generate comments, you may specify fields holding the comment and author for a given column.</td></tr><tr><td><strong>Cell comment author (XLSX)</strong></td><td>The XLSX format allows to put comments on cells. If you would like to generate comments, you may specify fields holding the comment and author for a given column.</td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/xiaoymin/blog-ai/blob/master/programmer/blog/kettle/2019-08-15-kettle-19.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">最后<!-- -->由 <b>xiaoyumin</b> <!-- -->于 <b><time datetime="2023-06-11T10:11:43.000Z">2023年6月11日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/kettle/2019-08-15-kettle-18"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Kettle实战100篇 第18篇 JavaScript脚本组件使用示例</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/kettle/2019-08-15-kettle-20"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Kettle实战100篇 第20篇 MySQL数据库导出到ElasticSearch</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#microsoft-excel-输出" class="table-of-contents__link toc-highlight">Microsoft Excel 输出</a><ul><li><a href="#文件选项" class="table-of-contents__link toc-highlight">文件选项</a></li><li><a href="#内容选项" class="table-of-contents__link toc-highlight">内容选项</a></li><li><a href="#个性化选项" class="table-of-contents__link toc-highlight">个性化选项</a></li><li><a href="#字段选项卡" class="table-of-contents__link toc-highlight">字段选项卡</a></li><li><a href="#元数据支持" class="table-of-contents__link toc-highlight">元数据支持</a></li></ul></li><li><a href="#microsoft-excel-writer" class="table-of-contents__link toc-highlight">Microsoft Excel Writer</a><ul><li><a href="#常规" class="table-of-contents__link toc-highlight">常规</a></li><li><a href="#文件工作表-选项" class="table-of-contents__link toc-highlight">文件&amp;工作表 选项</a></li><li><a href="#内容选项-1" class="table-of-contents__link toc-highlight">内容选项</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 八一菜刀, Inc. Built with <a href="https://www.docusaurus.cn/" target="_blank" rel="noopener noreferrer">Docusaurus</a>.<br> 浙ICP备18027673号</div></div></div></footer></div>
<script src="/assets/js/runtime~main.794e3af1.js"></script>
<script src="/assets/js/main.91d01d7d.js"></script>
</body>
</html>