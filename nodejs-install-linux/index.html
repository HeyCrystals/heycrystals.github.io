<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.40.1" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>node.js应用Linux安装部署 &middot; 八一菜刀</title>

  
  <link type="text/css" rel="stylesheet" href="https://xiaoymin.github.io/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://xiaoymin.github.io/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://xiaoymin.github.io/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://xiaoymin.github.io/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://xiaoymin.github.io/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="https://xiaoymin.github.io/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="八一菜刀" />

  
</head>

  <body class=" ">
  <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://xiaoymin.github.io/"><h1>八一菜刀</h1></a>
      <p class="lead">
       顺着生命的河流一起流淌,体会身边的每份感动和感悟. 
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="https://xiaoymin.github.io/">主页</a> </li>
      <li><a href="https://xiaoymin.github.io/about/"> 关于作者 </a></li>
    </ul>

    <p>&copy; 2018. All rights reserved. </p>
  </div>
</div>

    <div class="content container">
    <div class="post">
  <h1>node.js应用Linux安装部署</h1>
  <span class="post-date">Thu, Apr 27, 2017</span>
  

<h2 id="目的">目的</h2>

<p>在Linux服务器部署node应用参考文档</p>

<h2 id="部署">部署</h2>

<h3 id="下载">下载</h3>

<p>首先去node.js官网下载node的安装包，官网地址：<a href="https://nodejs.org/en/download/">https://nodejs.org/en/download/</a></p>

<p>，下载tar.gz源码格式包</p>

<p><img src="clip_image002.jpg" alt="img" /></p>

<h3 id="环境">环境</h3>

<p>node的安装需要依赖gcc、g++等底层命令,安装node.js的新版本对gcc等命令的版本要求也不一样，这里v6.10.2所依赖的gcc 需要v4.8以上，低于这个版本安装不成功</p>

<p><img src="clip_image004.jpg" alt="img" /></p>

<h3 id="安装">安装</h3>

<p>执行以下命令,如果出现命令不存在的错误,需要安装或更新相关系统命令，然后再执行.</p>

<pre><code class="language-shell">tar -xvf node-v6.10.1.tar.gz

./configure

make &amp;&amp; make install
</code></pre>

<h3 id="配置环境变量">配置环境变量</h3>

<p>按照上面默认安装,一般node.js会产生两个主要命令，命令默认在/usr/local/bin目录下，如果该目录配置在/etc/profile，则无需配置</p>

<p>node：node.js的核心命令，运行js的node服务</p>

<p>npm：node.js依赖包安装命令,node的第三方依赖都可以通过npm来安装</p>

<p>配置方法：</p>

<pre><code class="language-shell">vim /etc/profile
</code></pre>

<p>追加node的环境</p>

<pre><code class="language-shell">export PATH=/usr/local/bin:$PATH
</code></pre>

<p>profile生效</p>

<pre><code class="language-shell">source /etc/profile
</code></pre>

<h3 id="验证">验证</h3>

<p>在终端指向命令,验证node是否安装成功,返回表示安装成功，提示node命令不存在则是环境变量配置不正确</p>

<pre><code class="language-shell">node -v
</code></pre>

<p><img src="clip_image005.png" alt="img" /></p>

<h3 id="安装淘宝镜像">安装淘宝镜像</h3>

<p>因为npm安装命令连接的是国外服务器，我们使用npm安装node的依赖时候速度可能会非常慢,所以使用国内淘宝提供的cnpm来代替</p>

<p>参考文档：<a href="https://npm.taobao.org/">https://npm.taobao.org/</a></p>

<p>安装命令：</p>

<pre><code class="language-shell">npm install -g cnpm--registry=https://registry.npm.taobao.org
</code></pre>

<h3 id="安装pm2">安装pm2</h3>

<p>PM2 是一个带有负载均衡功能的 Node 应用的进程管理器。</p>

<p>当你要把你的独立代码利用全部的服务器上的所有 CPU，并保证进程永远都活着，0 秒的重载， PM2 是完美的。它非常适合 IaaS 结构，但不要把它用于 PaaS 方案（随后将开发 Paas 的解决方案）。</p>

<p>备注：</p>

<ul>
<li>SaaS、PaaS 和 IaaS 是云服务模式</li>
<li>SaaS 软件即服务，例如 Google 的 Gmail 邮箱服务，面向应用型用户</li>
<li>PaaS 平台即服务，例如 Google 的 GAE，面向开发型用户</li>
<li>IaaS 基础架构即服务，例如亚马逊的 AWS，IaaS 对于不知道新推出的应用程序/网站会有多成功的创业公司来说非常有用</li>
</ul>

<p>这里推荐使用pm2 启动node.js应用服务,相对于node本身命令,稳定,适合在服务器上部署</p>

<p>参考文档：<a href="http://pm2.keymetrics.io/docs/usage/quick-start/">http://pm2.keymetrics.io/docs/usage/quick-start/</a></p>

<p>安装</p>

<pre><code>cnpm install -g pm2
</code></pre>

<h3 id="启动服务">启动服务</h3>

<p>一般node.js应用在Linux部署是不部署node_modules文件夹的，在线安装依赖，每个node.js应用都有package.json文件，该文件保存了node应用所依赖的各个组件，切到该目录执行命令cnpm install</p>

<p>该命令执行后会自动安装依赖组件,并生成node_modules文件夹</p>

<p>使用pm2来启动命令</p>

<p><img src="clip_image009.jpg" alt="img" /></p>

<p>node的端口一般都会在启动js里面配置,可以使用vim命令对端口进行修改</p>

<h3 id="nginx配置">nginx配置</h3>

<p>node.js相当于java的服务，是类似于APP端的客户端程序，目前Java所承担的是接口服务的角色,所以不需要对外公开服务，只需要公开node的服务即可</p>

<p><img src="clip_image011.jpg" alt="img" /></p>

</div>


    </div>

    
  </body>
</html>